<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <title>Bayesian Statistics Spring 2025 - mlm</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">mlm</h1>

<div class="quarto-title-authors">
</div>

</section>
<section class="slide level2">


<img data-src="chelsea.jpeg" class="r-stretch"></section>
<section id="mlm-review" class="slide level2">
<h2>MLM review</h2>
<p><span class="math display">\[{Y}_{i} = b_{0} + b_{1}X_{i} +  ... +\epsilon_{i}\]</span></p>
<p><span class="math display">\[{Y}_{ij} = b_{0} + b_{1}X_{ij} + ... +\epsilon_{ij}\]</span> Where j refers to some clustering or grouping variable and i refers to the observations within j</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>data <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/josh-jackson/bayes/master/mlm.csv"</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>mlm <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">set.seed</span>(<span class="dv">114</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>mlm <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">sample_n_of</span>(<span class="dv">20</span>, ID) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> CON, <span class="at">group =</span> ID, <span class="at">fill =</span> ID)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID))) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID)),<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="empty-model" class="slide level2">
<h2>Empty model</h2>
<p>Level 1 <span class="math display">\[{Y}_{ij} = \beta_{0i}  + \varepsilon_{ij}\]</span></p>
<p>Level 2 <span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0j}\]</span></p>
<p><span class="math display">\[{U}_{0i} \sim N(0, \tau_{00}^{2})\]</span> <span class="math display">\[{e}_{ii} \sim N(0, \sigma^{2})\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>mlm <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">sample_n_of</span>(<span class="dv">8</span>, ID) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> CON, <span class="at">group =</span> ID)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID))) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID)), <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula=</span>y<span class="sc">~</span><span class="dv">1</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"><p><span class="math display">\[{Y}_{ij} = \gamma_{00} + U_{0i}  + \varepsilon_{ij}\]</span></p>
<p>Akin to ANOVA if we treat <span class="math inline">\(U_{0j}\)</span> as between subjects variance &amp; <span class="math inline">\(\varepsilon_{ij}\)</span> as within subjects variance.</p>
</section>
<section id="random-and-fixed-effects" class="slide level2">
<h2>Random and fixed effects</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0i}  + \varepsilon_{ij}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span> Combined: <span class="math display">\[{Y}_{ij} = \gamma_{00} + U_{0i}  + \varepsilon_{ij}\]</span></p>
</div><div class="column" style="width:60%;">
<p><span class="math inline">\(U_{0i}\)</span> is considered a random effect, as it is varies across our grouping</p>
<p><span class="math inline">\(\gamma_{00}\)</span> is considered a fixed effect, as it is what is fixed (average) across our grouping</p>
</div>
</div>
</section>
<section id="level-1-predictors" class="slide level2">
<h2>Level 1 predictors</h2>
<p>Level 1 is where you have data that repeats within your grouping or clustering data. Is your cluster classrooms? Then students are level 1. Is your cluster people? Then observations are level 1.</p>
<p><span class="math display">\[{Y}_{ij} = \beta_{0i}  + \beta_{1i}X_{ij} + \varepsilon_{ij}\]</span> Notice on the subscript of X that these predictors vary across group (i) and within the group (i) So if your grouping (i) is people, then j refers to different observations.</p>
</section>
<section class="slide level2">

<p>Level 2 takes the parameters at level 1 and decomposes them into a fixed component ( <span class="math inline">\(\gamma\)</span> ) that reflects the average and, if desired, the individual deviations around that fixed effect (U).</p>
<p>level 1 <span class="math display">\[{Y}_{ij} = \beta_{0i}  + \beta_{1i}X_{ij} + \varepsilon_{ij}\]</span></p>
<p>level 2 <span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span><br>
<span class="math display">\[{\beta}_{1i} = \gamma_{10}\]</span></p>
</section>
<section class="slide level2">

<p>Level 1:</p>
<p><span class="math display">\[{Y}_{ij} = \beta_{0i}  + \beta_{1i}X_{ij} + \varepsilon_{ij}\]</span> Level 2:<br>
<span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} + U_{1i}\]</span></p>
<p>Combined <span class="math display">\[{Y}_{ij} = \gamma_{00} + \gamma_{10}(X_{ij})+ U_{0i} + U_{1i}(X_{ij}) + \varepsilon_{ij}\]</span></p>
<p>Can think of a persons score divided up into a fixed component as well as the random component.</p>
<p><span class="math display">\[{\beta}_{16} = \gamma_{10} \pm U_{16}\]</span></p>
</section>
<section id="error-structure" class="slide level2">
<h2>Error structure</h2>
<p>The residual structure, where the random effects are again normally distributed with a mean of zero, but this time one must also consider covariance in addition to variance.</p>
<p><span class="math display">\[\begin{pmatrix} {U}_{0i} \\ {U}_{1i} \end{pmatrix}
\sim N \begin{pmatrix} 0,      \tau_{00}^{2} &amp; \tau_{01}\\ 0,  \tau_{01} &amp; \tau_{10}^{2} \end{pmatrix}\]</span></p>
<p>Note that it is possible to have a different error structure for the random effects</p>
<p><span class="math display">\[{e}_{ij} \sim N(0, \sigma^{2})\]</span></p>
</section>
<section id="multiple-level-1-predictors" class="slide level2">
<h2>Multiple level 1 predictors</h2>
<p>Level 1:</p>
<p><span class="math display">\[{Y}_{ij} = \beta_{0i}  + \beta_{1i}X_{ij} + \beta_{2i}Z_{ij} + \varepsilon_{ij}\]</span> Level 2:<br>
<span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} + U_{1i}\]</span> <span class="math display">\[{\beta}_{2i} = \gamma_{20} + U_{2i}\]</span></p>
</section>
<section id="level-2-predictors" class="slide level2">
<h2>Level 2 predictors</h2>
<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0i}  + \beta_{1i}X_{ij} + \varepsilon_{ij}\]</span> Level 2: <span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}G_{i} +   U_{0i}\]</span><br>
<span class="math display">\[{\beta}_{1i} = \gamma_{10} + U_{1i}\]</span></p>
</section>
<section class="slide level2">

<p>Combined <span class="math display">\[{Y}_{ij} = \gamma_{00} + \gamma_{01}G_{i}+  \gamma_{10} (X_{ij}) + U_{0i} + U_{1i}(X_{ij}) + \varepsilon_{ij}\]</span> <span class="math display">\[{Y}_{ij} = [\gamma_{00} + \gamma_{01}G_{i}+ U_{0i}]  + [(\gamma_{10}  + U_{1i})(X_{ij})] + \varepsilon_{ij}\]</span></p>
</section>
<section id="cross-level-interactions" class="slide level2">
<h2>Cross level interactions</h2>
<p>level 1: <span class="math display">\[{Y}_{ij} = \beta_{0i}  + \beta_{1i}X_{ij} + \varepsilon_{ij}\]</span> Level 2: <span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}G_{i} +   U_{0i}\]</span><br>
<span class="math display">\[{\beta}_{1i} = \gamma_{10} + \gamma_{11}G_{j} + U_{1j}\]</span><br>
<span class="math display">\[{Y}_{ij} = \gamma_{00} + \gamma_{01}G_{i}+  \gamma_{10} (X_{ij}) + \gamma_{11}(G_{i}*X{ij}) +  U_{0i} + U_{1i}(X{ij}) + \varepsilon_{ij}\]</span> ———-</p>
<p><span class="math display">\[{Y}_{ij} = [\gamma_{00} + U_{0i} +\gamma_{01}G_{i}] + [(\gamma_{10}  + \gamma_{11}G_{i}+  U_{1i})(X{ij})] + \varepsilon_{ij}\]</span></p>
</section>
<section id="centering" class="slide level2">
<h2>Centering</h2>
<p>As a rule, each level-1 predictor is usually really 2 predictor variables. It is important to separate within-group from between group variance. Failing to do so will “smush” between and within variance to level 1.</p>
<p>Example: student SES at level 1, with schools at level 2. Some kids have more money than other kids in their school Some schools have more money than other schools</p>
<p>Fortunately it is easy to separate this</p>
</section>
<section class="slide level2">

<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0i}  + \beta_{1i}(X_{ij}- \bar{X_i}) + \varepsilon_{ij}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0i} = \gamma_{00} + \bar{X_i} +   U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} + \bar{X_i} + U_{1i}\]</span></p>
<p>Could also grand mean center the level 2 means so that the interaction has a meaningful zero point.</p>
</section>
<section id="mlm-as-default-and-make-it-maximum" class="slide level2">
<h2>MLM as default and make it maximum</h2>
<p>If you have data like this you should analyze like this! If you don’t, then you are losing information (GEE being a potential exception).</p>
<p>The question often is about which random effects to fit. There are multiple opinions, but mine is to start maximum, and then work downward (ie simplify) if necessary/consistent with theory. It doesn’t really hurt to include them, especially within Bayesian estimation!</p>
</section>
<section id="mlm-intuitions" class="slide level2">
<h2>MLM intuitions</h2>
<p>Anytime you have repeated DVs you should use MLM as opposed to doing aggregation outside the model. While that should be your default, it is helpful to conceptualize why it is helpful.</p>
<ol type="1">
<li>Aggregation is bad</li>
<li>Regressions within regressions (ie coefficients as outcomes)</li>
<li>Questions at different levels</li>
<li>Variance decomposition<br>
</li>
<li>Learning from other data through pooling/shrinkage</li>
<li>Parameters that depend on parameters</li>
</ol>
</section>
<section id="aggregation-obscures-hypotheses" class="slide level2">
<h2>1. Aggregation obscures hypotheses</h2>
<p>What if people had more than 1 DV, like we do with time? What do you do with multiple items, multiple trials, multiple ____ ?</p>
<p>Two options: 1. Collapse and average across.</p>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">library</span>(broom)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a>simp<span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="sc">~</span>ID, <span class="sc">~</span>group,  <span class="sc">~</span>test.score, <span class="sc">~</span>study,</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">3</span>,</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">4</span>,</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,</span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,</span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,</span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">6</span>,</span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="dv">9</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,</span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Could aggragate across group</p>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">


<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section>
<section id="aggregation-obscures-hypotheses-1" class="slide level2">
<h2>1. Aggregation obscures hypotheses</h2>
<ul>
<li><p>Between person H1: Do students who study more get better grades?</p></li>
<li><p>Within person H2: When a student studies, do they get better grades?</p></li>
<li><p>H1 and H2 are independent from one another! Aggregation collapses the two. When you have nested data with many DVs it is important to not aggregate.</p></li>
<li><p>#compositeskill</p></li>
</ul>
</section>
<section id="regressions-within-regressions" class="slide level2">
<h2>2. Regressions within regressions</h2>
<p>Helps to take multilevel and split it into the different levels.</p>
<p>Level 1 is the smallest unit of analysis (students, waves, trials, family members)</p>
<p>Level 2 variables are what level 1 variables are “nested” in (people, schools, counties, families, dyads)</p>
<p>We are going to use level one components to run a regression, all the while level 1 is also estimating a regression. (Coefficents as outcomes)</p>
</section>
<section id="stroop-example" class="slide level2">
<h2>Stroop example</h2>
<p>We calculate stroop scores by looking at repeated trials of congruent vs not congruent. This is dummy coded such that the <span class="math inline">\(\beta_{1}\)</span> reflects the average stroop effect. How much slower are people in incongruent trials?</p>
<p><span class="math display">\[Y_{i} = \beta_{0} + \beta_{1}X_{1} + \varepsilon_i\]</span></p>
</section>
<section class="slide level2">

<p><span class="math display">\[Y_{trials, i} = \beta_{0i} + \beta_{1i}X_{trial,i} + \varepsilon_{trial,i}\]</span></p>
<p><span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span> <span class="math display">\[\beta_{1} = \gamma_{10} +\gamma_{11}Age_i+ U_{1i}\]</span></p>
<p>Our B1 coefficient indexes the stroop effect. However, people differ on this stroop effect. There is some average effect (fixed effect) that people vary around. Each person has some personal <span class="math inline">\(\beta_1\)</span>, which we find using Level 1 data. From there we can also ask questions (with regressions) about that random variable.</p>
</section>
<section class="slide level2">

<p>People differ on the stroop</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>example <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/longitudinal-2021/master/example.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>example<span class="sc">$</span>year <span class="ot">&lt;-</span> example<span class="sc">$</span>week</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a>ex.random <span class="ot">&lt;-</span> example <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7"></a>  distinct <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">sample_n</span>(<span class="dv">3</span>) </span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a>example2 <span class="ot">&lt;-</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="fu">left_join</span>(ex.random, example)  </span>
<span id="cb5-12"><a href="#cb5-12"></a>  </span>
<span id="cb5-13"><a href="#cb5-13"></a>g2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(example2,</span>
<span id="cb5-14"><a href="#cb5-14"></a>   <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7, <span class="at">group =</span> ID)) <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">formula=</span>y<span class="sc">~</span><span class="dv">1</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span>ID) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">13</span>) <span class="sc">+</span>  <span class="fu">ylab</span>(<span class="st">"stroop effect"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"trials"</span>) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="fu">geom_label</span>(<span class="at">label=</span><span class="st">"Grand mean "</span>,  <span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span>.<span class="dv">13</span>,</span>
<span id="cb5-17"><a href="#cb5-17"></a>    <span class="at">label.size =</span> <span class="fl">0.15</span>) </span>
<span id="cb5-18"><a href="#cb5-18"></a>g2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb6-2"><a href="#cb6-2"></a>example <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">do</span>(<span class="at">avg =</span> <span class="fu">tidy</span>(<span class="fu">lm</span>(SMN7 <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> .))) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">unnest</span>(avg) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate)) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">stat_dotsinterval</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section id="diferent-levels" class="slide level2">
<h2>3. Diferent levels</h2>
<p>To sum up the first two ways to think about regression, we take a relationship that could be simplified by aggregation, and conduct regressions from regressions. (Regression inception)</p>
<p>The third way is to think of questions at different levels. At level 1 we can ask lower-unit questions e.g., if trials are nested within person, what predicts lengthier trials?</p>
<p>If level 1 is made up of repeated observations, then we can ask level 1/observation level questions like does failure at the trial level impact future trial performance.</p>
</section>
<section class="slide level2">

<p>At level 2 we can ask broader-unit questions. E.g., is age associated with stroop differences</p>
<p>Often level 2 is between person variables.</p>
<p>Both levels are simple regressions. Level 2 uses coefficients from level 1 as DVs. Level 1 variables are time varying, level 2 variables are time invariant</p>
</section>
<section id="variance-decomposition" class="slide level2">
<h2>4. Variance decomposition</h2>
<p>For standard regression, we think of error as existing in one big bucket called <span class="math inline">\(\varepsilon\)</span> . Everything that we do not know goes into that bucket, from measurement error to unmeasured important factors.</p>
<p>For MLMs we will be breaking up ( <span class="math inline">\(\varepsilon\)</span> ) into multiple buckets. These useful “buckets” (Us) are what we refer to as random/varying effects.</p>
<p><span class="math display">\[Y_{trials, i} = \beta_{0i} + \beta_{1i}X_{trial,i} + \varepsilon_{trial}\]</span> <span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span> <span class="math display">\[\beta_{1} = \gamma_{10} +\gamma_{11}Z_i+ U_{1i}\]</span></p>
</section>
<section class="slide level2">


<img data-src="btw.png" class="r-stretch"><p>Assume a simple intercept only model where we aggregate across types of trials.</p>
</section>
<section class="slide level2">


<img data-src="win.png" class="r-stretch"><p>A MLM intercept only model takes what was previously chalked up to error and reassigns it into person specific “buckets”</p>
</section>
<section class="slide level2">

<p>Model for the means (like normal) and now we have a model for the variance (random effects!)</p>
<p>We will treat random effects as variables themselves e.g.&nbsp;individual differences in reaction time or stroop effect. They index how much people DIFFER on some effect. e.g.&nbsp;does everyone show the same stroop effect?</p>
<p>We can relate the random effects to other random effects e.g., do people who show an effect have a slower reaction time?</p>
</section>
<section id="shrinkagepartial-pooling" class="slide level2">
<h2>5. Shrinkage/partial pooling</h2>
<ul>
<li><p>We treat our group variable as coming from a population. All groups are alike (because they are from the same population), but different in their own way. Because of this it is helpful to use information from other groups to help make predictions.</p></li>
<li><p>We do this in standard regression where we make predictions based on values from the whole dataset (not just binned Xs). We want to pool as this leads to better predictions as we are not overfitting our data!</p></li>
</ul>
</section>
<section class="slide level2">

<p>If we take our simplified stroop effect model (an empty model)</p>
<p><span class="math display">\[Y_{trials, i} = \beta_{0i} +  \varepsilon_{trial}\]</span></p>
<p><span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span></p>
<p>Where does <span class="math inline">\(U_{0i}\)</span> come from? If we calculated each by hand, through taking the average reaction time for a person i and subtracting that from the grand mean reaction time, would that equal <span class="math inline">\(U_{0i}\)</span> ?</p>
</section>
<section id="complete-partial-and-no-pooling" class="slide level2">
<h2>Complete, partial and no pooling</h2>
<ul>
<li><p>Complete assumes everyone is the same, with <span class="math inline">\(U_{0i}\)</span> being zero for everyone.</p></li>
<li><p>No pooling is if we calculate every person’s effect with a regression, subtracting out he grand mean average.</p></li>
<li><p>Partial pooling is in the middle, a weighted average between the two. For those with fewer trials there is less information for a particular individual, thus the complete pooling estimate will be given more weight. If someone has a lot of data, there weighted average is closer to no pooling.</p></li>
<li><p>Partial pooling prevents both over and under fitting of your data, leading to increased out of sample predictions.</p></li>
</ul>
</section>
<section id="complete-pooling" class="slide level2">
<h2>Complete pooling</h2>
<p>Ignores any dependency. Doesn’t learn from others, assumes everyone is the same. Underfits the model.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">ggplot</span>(mlm, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"test score"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"study"</span>) <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-2"><a href="#cb7-2"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="no-pooling" class="slide level2">
<h2>No Pooling</h2>
<p>Everyone is unqiue and we cannot learn from others. Leads to overfitting</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">ggplot</span>(mlm, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7, <span class="at">group =</span> ID)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span> ID) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"test score"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"study"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="partial-pooling-aka-shrinkage-aka-regularization" class="slide level2">
<h2>Partial pooling aka shrinkage aka regularization</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">ggplot</span>(mlm, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7, <span class="at">group =</span> ID, <span class="at">colour =</span> ID)) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span><span class="fu">scale_color_viridis</span>()<span class="sc">+</span>  <span class="fu">ylab</span>(<span class="st">"test score"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"study amount"</span>) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Partial pooling aka shrinkage provides the optimal amount of learning from others. Assumes people come from the same distribution but are distinct from one another.</p>
<p>If you have a little data, then the safe bet is to look at the average. If you have a lot of data, you can ignore others.</p>
<p>In a way, this is similar to Bayesian reasoning where learning is based on how much information you have about a person with other people serving as a prior.</p>
</section>
<section id="parameters-that-depend-on-other-parameters" class="slide level2">
<h2>6. Parameters that depend on other parameters</h2>
<p><span class="math display">\[\text{y}_{ij}  \sim \operatorname{Normal}(\mu_{ij}, \sigma)\]</span> <span class="math display">\[\mu_{ij}  = \beta_{0[i]}\]</span></p>
<p><span class="math display">\[\beta_{0[i]} \sim \operatorname{Normal}({\bar \mu},  \sigma_0)\]</span> <span class="math display">\[{\bar \mu}  \sim {\operatorname{Normal}(0, 1.5)}\]</span> <span class="math display">\[\sigma_0 \sim {\operatorname{Exponential}(1)}\]</span> <span class="math display">\[\sigma \sim {\operatorname{Exponential}(1)}\]</span></p>
</section>
<section id="hyperprior" class="slide level2">
<h2>Hyperprior</h2>
<p>We now have a prior for the population of effects. We typically put a prior directly on parameters. Here, because are using a multilevel model, we are interested in the population of intercepts, not just a single intercept.</p>
<p>Intercept in simple regression –&gt; a (prior/posterior) distribution of possible scores</p>
<p>Intercept in mlm –&gt; a distribution of group/clusters of intercepts. The population we are sampling from can have a distribution (mu, sigma), and that distribution is different from the observed distribution of mu (or sigma)</p>
</section>
<section id="parameters-that-depend-on-parameters" class="slide level2">
<h2>Parameters that depend on parameters</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># normal density</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">library</span>(beyonce)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a>bp <span class="ot">&lt;-</span> <span class="fu">beyonce_palette</span>(<span class="dv">128</span>, <span class="at">n =</span> <span class="dv">9</span>, <span class="at">type =</span> <span class="st">"continuous"</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-13"><a href="#cb10-13"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-14"><a href="#cb10-14"></a>           <span class="at">label =</span> <span class="st">"normal"</span>,</span>
<span id="cb10-15"><a href="#cb10-15"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-17"><a href="#cb10-17"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-18"><a href="#cb10-18"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"italic(M)[0]"</span>, <span class="st">"italic(S)[0]"</span>), </span>
<span id="cb10-19"><a href="#cb10-19"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-20"><a href="#cb10-20"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-21"><a href="#cb10-21"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-22"><a href="#cb10-22"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-23"><a href="#cb10-23"></a></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co"># half-normal density</span></span>
<span id="cb10-25"><a href="#cb10-25"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb10-26"><a href="#cb10-26"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-27"><a href="#cb10-27"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-30"><a href="#cb10-30"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-31"><a href="#cb10-31"></a>           <span class="at">label =</span> <span class="st">"half-normal"</span>,</span>
<span id="cb10-32"><a href="#cb10-32"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-33"><a href="#cb10-33"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-34"><a href="#cb10-34"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-35"><a href="#cb10-35"></a>           <span class="at">label =</span> <span class="st">"0*','*~italic(S)[sigma][0]"</span>, </span>
<span id="cb10-36"><a href="#cb10-36"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-37"><a href="#cb10-37"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-38"><a href="#cb10-38"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-39"><a href="#cb10-39"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-40"><a href="#cb10-40"></a></span>
<span id="cb10-41"><a href="#cb10-41"></a>my_arrow <span class="ot">&lt;-</span> <span class="fu">arrow</span>(<span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.35</span>, <span class="st">"cm"</span>), <span class="at">type =</span> <span class="st">"closed"</span>)</span>
<span id="cb10-42"><a href="#cb10-42"></a></span>
<span id="cb10-43"><a href="#cb10-43"></a></span>
<span id="cb10-44"><a href="#cb10-44"></a><span class="co"># a second normal density</span></span>
<span id="cb10-45"><a href="#cb10-45"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb10-46"><a href="#cb10-46"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-47"><a href="#cb10-47"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-48"><a href="#cb10-48"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-49"><a href="#cb10-49"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-50"><a href="#cb10-50"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-51"><a href="#cb10-51"></a>           <span class="at">label =</span> <span class="st">"normal"</span>,</span>
<span id="cb10-52"><a href="#cb10-52"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-53"><a href="#cb10-53"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-54"><a href="#cb10-54"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-55"><a href="#cb10-55"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"italic(M)[1]"</span>, <span class="st">"italic(S)[1]"</span>), </span>
<span id="cb10-56"><a href="#cb10-56"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-57"><a href="#cb10-57"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-58"><a href="#cb10-58"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-59"><a href="#cb10-59"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-60"><a href="#cb10-60"></a></span>
<span id="cb10-61"><a href="#cb10-61"></a><span class="co"># a second half-normal density</span></span>
<span id="cb10-62"><a href="#cb10-62"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb10-63"><a href="#cb10-63"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-64"><a href="#cb10-64"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-65"><a href="#cb10-65"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-66"><a href="#cb10-66"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-67"><a href="#cb10-67"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-68"><a href="#cb10-68"></a>           <span class="at">label =</span> <span class="st">"half-normal"</span>,</span>
<span id="cb10-69"><a href="#cb10-69"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-70"><a href="#cb10-70"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-71"><a href="#cb10-71"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-72"><a href="#cb10-72"></a>           <span class="at">label =</span> <span class="st">"0*','*~italic(S)[sigma][1]"</span>, </span>
<span id="cb10-73"><a href="#cb10-73"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-74"><a href="#cb10-74"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-75"><a href="#cb10-75"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-76"><a href="#cb10-76"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-77"><a href="#cb10-77"></a></span>
<span id="cb10-78"><a href="#cb10-78"></a><span class="co"># four annotated arrows</span></span>
<span id="cb10-79"><a href="#cb10-79"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb10-80"><a href="#cb10-80"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">35</span>, .<span class="dv">65</span>, .<span class="dv">95</span>),</span>
<span id="cb10-81"><a href="#cb10-81"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb10-82"><a href="#cb10-82"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">32</span>, .<span class="dv">4</span>, .<span class="dv">65</span>, .<span class="dv">72</span>),</span>
<span id="cb10-83"><a href="#cb10-83"></a>         <span class="at">yend =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">2</span>, .<span class="dv">2</span>, .<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-84"><a href="#cb10-84"></a>  </span>
<span id="cb10-85"><a href="#cb10-85"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb10-86"><a href="#cb10-86"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb10-87"><a href="#cb10-87"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-88"><a href="#cb10-88"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-89"><a href="#cb10-89"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">35</span>, .<span class="dv">625</span>, .<span class="dv">78</span>), <span class="at">y =</span> .<span class="dv">55</span>,</span>
<span id="cb10-90"><a href="#cb10-90"></a>           <span class="at">label =</span> <span class="st">"'~'"</span>,</span>
<span id="cb10-91"><a href="#cb10-91"></a>           <span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-92"><a href="#cb10-92"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-93"><a href="#cb10-93"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb10-94"><a href="#cb10-94"></a></span>
<span id="cb10-95"><a href="#cb10-95"></a><span class="co"># third normal density</span></span>
<span id="cb10-96"><a href="#cb10-96"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb10-97"><a href="#cb10-97"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-98"><a href="#cb10-98"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-99"><a href="#cb10-99"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-100"><a href="#cb10-100"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-101"><a href="#cb10-101"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-102"><a href="#cb10-102"></a>           <span class="at">label =</span> <span class="st">"normal"</span>,</span>
<span id="cb10-103"><a href="#cb10-103"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-104"><a href="#cb10-104"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-105"><a href="#cb10-105"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-106"><a href="#cb10-106"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"mu[0]"</span>, <span class="st">"sigma[0]"</span>), </span>
<span id="cb10-107"><a href="#cb10-107"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-108"><a href="#cb10-108"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-109"><a href="#cb10-109"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-110"><a href="#cb10-110"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-111"><a href="#cb10-111"></a></span>
<span id="cb10-112"><a href="#cb10-112"></a><span class="co"># fourth normal density</span></span>
<span id="cb10-113"><a href="#cb10-113"></a>p7 <span class="ot">&lt;-</span></span>
<span id="cb10-114"><a href="#cb10-114"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-115"><a href="#cb10-115"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-116"><a href="#cb10-116"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-117"><a href="#cb10-117"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-118"><a href="#cb10-118"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-119"><a href="#cb10-119"></a>           <span class="at">label =</span> <span class="st">"normal"</span>,</span>
<span id="cb10-120"><a href="#cb10-120"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-121"><a href="#cb10-121"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-122"><a href="#cb10-122"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-123"><a href="#cb10-123"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"mu[1]"</span>, <span class="st">"sigma[1]"</span>), </span>
<span id="cb10-124"><a href="#cb10-124"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-125"><a href="#cb10-125"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-126"><a href="#cb10-126"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-127"><a href="#cb10-127"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-128"><a href="#cb10-128"></a></span>
<span id="cb10-129"><a href="#cb10-129"></a><span class="co"># two annotated arrows</span></span>
<span id="cb10-130"><a href="#cb10-130"></a>p8 <span class="ot">&lt;-</span></span>
<span id="cb10-131"><a href="#cb10-131"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">18</span>, .<span class="dv">82</span>),</span>
<span id="cb10-132"><a href="#cb10-132"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb10-133"><a href="#cb10-133"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">36</span>, .<span class="dv">55</span>),</span>
<span id="cb10-134"><a href="#cb10-134"></a>         <span class="at">yend =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-135"><a href="#cb10-135"></a>  </span>
<span id="cb10-136"><a href="#cb10-136"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb10-137"><a href="#cb10-137"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb10-138"><a href="#cb10-138"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-139"><a href="#cb10-139"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-140"><a href="#cb10-140"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">18</span>, .<span class="dv">33</span>, .<span class="dv">64</span>, .<span class="dv">77</span>), <span class="at">y =</span> .<span class="dv">55</span>,</span>
<span id="cb10-141"><a href="#cb10-141"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"'~'"</span>, <span class="st">"italic(j)"</span>, <span class="st">"'~'"</span>, <span class="st">"italic(j)"</span>),</span>
<span id="cb10-142"><a href="#cb10-142"></a>           <span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">7</span>), </span>
<span id="cb10-143"><a href="#cb10-143"></a>           <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-144"><a href="#cb10-144"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-145"><a href="#cb10-145"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb10-146"><a href="#cb10-146"></a></span>
<span id="cb10-147"><a href="#cb10-147"></a><span class="co"># exponential density</span></span>
<span id="cb10-148"><a href="#cb10-148"></a>p9 <span class="ot">&lt;-</span></span>
<span id="cb10-149"><a href="#cb10-149"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-150"><a href="#cb10-150"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dexp</span>(x, <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dexp</span>(x, <span class="dv">2</span>))))) <span class="sc">+</span></span>
<span id="cb10-151"><a href="#cb10-151"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-152"><a href="#cb10-152"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-153"><a href="#cb10-153"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-154"><a href="#cb10-154"></a>           <span class="at">label =</span> <span class="st">"exp"</span>,</span>
<span id="cb10-155"><a href="#cb10-155"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-156"><a href="#cb10-156"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-157"><a href="#cb10-157"></a>           <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-158"><a href="#cb10-158"></a>           <span class="at">label =</span> <span class="st">"italic(K)"</span>,</span>
<span id="cb10-159"><a href="#cb10-159"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-160"><a href="#cb10-160"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-161"><a href="#cb10-161"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-162"><a href="#cb10-162"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-163"><a href="#cb10-163"></a></span>
<span id="cb10-164"><a href="#cb10-164"></a><span class="co"># likelihood formula</span></span>
<span id="cb10-165"><a href="#cb10-165"></a>p10 <span class="ot">&lt;-</span></span>
<span id="cb10-166"><a href="#cb10-166"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> .<span class="dv">5</span>,</span>
<span id="cb10-167"><a href="#cb10-167"></a>         <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb10-168"><a href="#cb10-168"></a>         <span class="at">label =</span> <span class="st">"beta[0][italic(j)]+beta[1][italic(j)]*italic(x)[italic(i)*'|'*italic(j)]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-169"><a href="#cb10-169"></a>  </span>
<span id="cb10-170"><a href="#cb10-170"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb10-171"><a href="#cb10-171"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">"Times"</span>) <span class="sc">+</span></span>
<span id="cb10-172"><a href="#cb10-172"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb10-173"><a href="#cb10-173"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-174"><a href="#cb10-174"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb10-175"><a href="#cb10-175"></a></span>
<span id="cb10-176"><a href="#cb10-176"></a><span class="co"># half-normal density</span></span>
<span id="cb10-177"><a href="#cb10-177"></a>p11 <span class="ot">&lt;-</span></span>
<span id="cb10-178"><a href="#cb10-178"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-179"><a href="#cb10-179"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dnorm</span>(x)) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dnorm</span>(x)))) <span class="sc">+</span></span>
<span id="cb10-180"><a href="#cb10-180"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-181"><a href="#cb10-181"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-182"><a href="#cb10-182"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-183"><a href="#cb10-183"></a>           <span class="at">label =</span> <span class="st">"half-normal"</span>,</span>
<span id="cb10-184"><a href="#cb10-184"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-185"><a href="#cb10-185"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-186"><a href="#cb10-186"></a>           <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-187"><a href="#cb10-187"></a>           <span class="at">label =</span> <span class="st">"0*','*~italic(S)[sigma]"</span>, </span>
<span id="cb10-188"><a href="#cb10-188"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-189"><a href="#cb10-189"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-190"><a href="#cb10-190"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-191"><a href="#cb10-191"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-192"><a href="#cb10-192"></a></span>
<span id="cb10-193"><a href="#cb10-193"></a><span class="co"># four annotated arrows</span></span>
<span id="cb10-194"><a href="#cb10-194"></a>p12 <span class="ot">&lt;-</span></span>
<span id="cb10-195"><a href="#cb10-195"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">c</span>(.<span class="dv">43</span>, .<span class="dv">43</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>),</span>
<span id="cb10-196"><a href="#cb10-196"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">55</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb10-197"><a href="#cb10-197"></a>         <span class="at">xend =</span> <span class="fu">c</span>(.<span class="dv">43</span>, <span class="fl">1.225</span>, <span class="fl">1.5</span>, <span class="fl">1.75</span>),</span>
<span id="cb10-198"><a href="#cb10-198"></a>         <span class="at">yend =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">15</span>, .<span class="dv">2</span>, .<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-199"><a href="#cb10-199"></a>  </span>
<span id="cb10-200"><a href="#cb10-200"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb10-201"><a href="#cb10-201"></a>             <span class="at">y =</span> y, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb10-202"><a href="#cb10-202"></a>  <span class="fu">geom_segment</span>(<span class="at">arrow =</span> my_arrow, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-203"><a href="#cb10-203"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-204"><a href="#cb10-204"></a>           <span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">3</span>, .<span class="dv">7</span>, <span class="fl">1.38</span>, <span class="dv">2</span>), <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">92</span>, .<span class="dv">22</span>, .<span class="dv">65</span>, .<span class="dv">6</span>),</span>
<span id="cb10-205"><a href="#cb10-205"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"'~'"</span>, <span class="st">"'='"</span>, <span class="st">"'='"</span>, <span class="st">"'~'"</span>),</span>
<span id="cb10-206"><a href="#cb10-206"></a>           <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb10-207"><a href="#cb10-207"></a>           <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-208"><a href="#cb10-208"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-209"><a href="#cb10-209"></a>           <span class="at">x =</span> .<span class="dv">43</span>, <span class="at">y =</span> .<span class="dv">7</span>,</span>
<span id="cb10-210"><a href="#cb10-210"></a>           <span class="at">label =</span> <span class="st">"nu*minute+1"</span>,</span>
<span id="cb10-211"><a href="#cb10-211"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-212"><a href="#cb10-212"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-213"><a href="#cb10-213"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb10-214"><a href="#cb10-214"></a></span>
<span id="cb10-215"><a href="#cb10-215"></a><span class="co"># student-t density</span></span>
<span id="cb10-216"><a href="#cb10-216"></a>p13 <span class="ot">&lt;-</span></span>
<span id="cb10-217"><a href="#cb10-217"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-218"><a href="#cb10-218"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> (<span class="fu">dt</span>(x, <span class="dv">3</span>) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">dt</span>(x, <span class="dv">3</span>))))) <span class="sc">+</span></span>
<span id="cb10-219"><a href="#cb10-219"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill =</span> bp[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-220"><a href="#cb10-220"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-221"><a href="#cb10-221"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">2</span>,</span>
<span id="cb10-222"><a href="#cb10-222"></a>           <span class="at">label =</span> <span class="st">"student t"</span>,</span>
<span id="cb10-223"><a href="#cb10-223"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb10-224"><a href="#cb10-224"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb10-225"><a href="#cb10-225"></a>           <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">6</span>,</span>
<span id="cb10-226"><a href="#cb10-226"></a>           <span class="at">label =</span> <span class="st">"nu~~mu[italic(i)*'|'*italic(j)]~~sigma"</span>,</span>
<span id="cb10-227"><a href="#cb10-227"></a>           <span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">family =</span> <span class="st">"Times"</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb10-228"><a href="#cb10-228"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb10-229"><a href="#cb10-229"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb10-230"><a href="#cb10-230"></a>  <span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> bp[<span class="dv">1</span>]))</span>
<span id="cb10-231"><a href="#cb10-231"></a></span>
<span id="cb10-232"><a href="#cb10-232"></a><span class="co"># the final annotated arrow</span></span>
<span id="cb10-233"><a href="#cb10-233"></a>p14 <span class="ot">&lt;-</span></span>
<span id="cb10-234"><a href="#cb10-234"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> <span class="fu">c</span>(.<span class="dv">375</span>, .<span class="dv">625</span>),</span>
<span id="cb10-235"><a href="#cb10-235"></a>         <span class="at">y     =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb10-236"><a href="#cb10-236"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"'~'"</span>, <span class="st">"italic(i)*'|'*italic(j)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-237"><a href="#cb10-237"></a>  </span>
<span id="cb10-238"><a href="#cb10-238"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb10-239"><a href="#cb10-239"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">"Times"</span>) <span class="sc">+</span></span>
<span id="cb10-240"><a href="#cb10-240"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> .<span class="dv">5</span>, <span class="at">xend =</span> .<span class="dv">5</span>,</span>
<span id="cb10-241"><a href="#cb10-241"></a>               <span class="at">y =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb10-242"><a href="#cb10-242"></a>               <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">arrow =</span> my_arrow) <span class="sc">+</span></span>
<span id="cb10-243"><a href="#cb10-243"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-244"><a href="#cb10-244"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb10-245"><a href="#cb10-245"></a></span>
<span id="cb10-246"><a href="#cb10-246"></a><span class="co"># some text</span></span>
<span id="cb10-247"><a href="#cb10-247"></a>p15 <span class="ot">&lt;-</span></span>
<span id="cb10-248"><a href="#cb10-248"></a>  <span class="fu">tibble</span>(<span class="at">x     =</span> .<span class="dv">5</span>,</span>
<span id="cb10-249"><a href="#cb10-249"></a>         <span class="at">y     =</span> .<span class="dv">5</span>,</span>
<span id="cb10-250"><a href="#cb10-250"></a>         <span class="at">label =</span> <span class="st">"italic(y)[italic(i)*'|'*italic(j)]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-251"><a href="#cb10-251"></a>  </span>
<span id="cb10-252"><a href="#cb10-252"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb10-253"><a href="#cb10-253"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">color =</span> bp[<span class="dv">1</span>], <span class="at">parse =</span> T, <span class="at">family =</span> <span class="st">"Times"</span>) <span class="sc">+</span></span>
<span id="cb10-254"><a href="#cb10-254"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-255"><a href="#cb10-255"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb10-256"><a href="#cb10-256"></a></span>
<span id="cb10-257"><a href="#cb10-257"></a><span class="co"># define the layout</span></span>
<span id="cb10-258"><a href="#cb10-258"></a>layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb10-259"><a href="#cb10-259"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">3</span>),</span>
<span id="cb10-260"><a href="#cb10-260"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb10-261"><a href="#cb10-261"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb10-262"><a href="#cb10-262"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">13</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb10-263"><a href="#cb10-263"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">4</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">7</span>),</span>
<span id="cb10-264"><a href="#cb10-264"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">4</span>, <span class="at">b =</span> <span class="dv">5</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb10-265"><a href="#cb10-265"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb10-266"><a href="#cb10-266"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">5</span>),</span>
<span id="cb10-267"><a href="#cb10-267"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb10-268"><a href="#cb10-268"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">7</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">l =</span> <span class="dv">11</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb10-269"><a href="#cb10-269"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">6</span>, <span class="at">b =</span> <span class="dv">7</span>, <span class="at">l =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">11</span>),</span>
<span id="cb10-270"><a href="#cb10-270"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">11</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb10-271"><a href="#cb10-271"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">9</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">3</span>, <span class="at">r =</span> <span class="dv">13</span>),</span>
<span id="cb10-272"><a href="#cb10-272"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">12</span>, <span class="at">b =</span> <span class="dv">12</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>),</span>
<span id="cb10-273"><a href="#cb10-273"></a>  <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">13</span>, <span class="at">b =</span> <span class="dv">13</span>, <span class="at">l =</span> <span class="dv">7</span>, <span class="at">r =</span> <span class="dv">9</span>)</span>
<span id="cb10-274"><a href="#cb10-274"></a>)</span>
<span id="cb10-275"><a href="#cb10-275"></a></span>
<span id="cb10-276"><a href="#cb10-276"></a><span class="co"># combine and plot!</span></span>
<span id="cb10-277"><a href="#cb10-277"></a>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p6 <span class="sc">+</span> p7 <span class="sc">+</span> p5 <span class="sc">+</span> p9 <span class="sc">+</span> p10 <span class="sc">+</span> p11 <span class="sc">+</span> p8 <span class="sc">+</span> p13 <span class="sc">+</span> p12 <span class="sc">+</span> p14 <span class="sc">+</span> p15) <span class="sc">+</span> </span>
<span id="cb10-278"><a href="#cb10-278"></a>  <span class="fu">plot_layout</span>(<span class="at">design =</span> layout) <span class="sc">&amp;</span></span>
<span id="cb10-279"><a href="#cb10-279"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">&amp;</span></span>
<span id="cb10-280"><a href="#cb10-280"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>If we are estimating a mean, we can divide that up into two priors:</p>
<ol type="1">
<li><p>A distribution of our best guess at the mean e.g., N(3,.5) means I am very confident in my guess vs N(3,50). This is all about the mean.</p></li>
<li><p>A distribution that represents the spread around that mean e.g., N(0,1) suggests small spread vs (0,100) suggest people may differ a lot (Even though the distribution has the same mean).</p></li>
</ol>
<p>Fixed effect describes #1 whereas random effects describe #2</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb11-2"><a href="#cb11-2"></a>mlm<span class="fl">.1</span> <span class="ot">&lt;-</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb11-4"><a href="#cb11-4"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb11-5"><a href="#cb11-5"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb11-6"><a href="#cb11-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sd), </span>
<span id="cb11-7"><a href="#cb11-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb11-8"><a href="#cb11-8"></a>      <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb11-9"><a href="#cb11-9"></a>      <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<span id="cb11-10"><a href="#cb11-10"></a>      <span class="at">data =</span> mlm, </span>
<span id="cb11-11"><a href="#cb11-11"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb11-12"><a href="#cb11-12"></a>      <span class="at">file =</span> <span class="st">"mlm.1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you think about parameters you are estimating the number of priors are simple. But in terms of what those priors represent, they are providing a prior on a prior. The intercept and the SD are both providing estimates of means. We could model this 1 parameter (anova or index coded) or 2 (mlm)</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">summary</span>(mlm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 5000; warmup = 1000; thin = 1;
         total post-warmup draws = 16000

Multilevel Hyperparameters:
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.06      0.01     0.05     0.07 1.00     5761     8415

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.01     0.18     0.20 1.00     8349    10553

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00    10318    12737

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Notice we have one less parameter we are estimating.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>mlm<span class="fl">.2</span> <span class="ot">&lt;-</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb14-3"><a href="#cb14-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> ,</span>
<span id="cb14-4"><a href="#cb14-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb14-5"><a href="#cb14-5"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb14-6"><a href="#cb14-6"></a>      <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb14-7"><a href="#cb14-7"></a>      <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<span id="cb14-8"><a href="#cb14-8"></a>      <span class="at">data =</span> mlm, </span>
<span id="cb14-9"><a href="#cb14-9"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb14-10"><a href="#cb14-10"></a>      <span class="at">file =</span> <span class="st">"mlm.2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">summary</span>(mlm<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 5000; warmup = 1000; thin = 1;
         total post-warmup draws = 16000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.00     0.18     0.20 1.00    16589    10784

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.07      0.00     0.07     0.08 1.00    10191     9816

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>mlm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.1</span>, <span class="st">"loo"</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>mlm<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.2</span>, <span class="st">"loo"</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="fu">loo_compare</span>(mlm<span class="fl">.1</span>, mlm<span class="fl">.2</span>, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      elpd_diff se_diff
mlm.1   0.0       0.0  
mlm.2 -58.2       8.9  </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li><p>Notice how the intercept is the same in each of these models. Even the CIs. Conceptually they are different though. The intercept is directly modeled in the standard regression. In the MLM it is better thought of as the map of the distribution of random effects.</p></li>
<li><p>The population is larger than what we have. This is true for almost anything we do. We sample paradigms, we sample people, we usually never have a full population under our study. Don’t we want to model that variation?</p></li>
</ul>
</section>
<section class="slide level2">

<p><span class="math display">\[\text{y}_{ij}  \sim \operatorname{Normal}(\mu_{ij}, \sigma)\]</span> <span class="math display">\[\mu_{ij}  = \beta_{0[i]}\]</span> This parenthesis indicates we have varying intercepts that vary over individual i. Each parameter estimated needs a prior. <span class="math display">\[\beta_{0[i]} \sim \operatorname{Normal}({\bar \mu},  \sigma_0)\]</span> <span class="math display">\[{\bar \mu}  \sim {\operatorname{Normal}(0, 1.5)}\]</span> <span class="math display">\[\sigma_0 \sim {\operatorname{Exponential}(1)}\]</span> <span class="math display">\[\sigma \sim {\operatorname{Exponential}(1)}\]</span></p>
</section>
<section id="parameters-that-depend-on-parameters-1" class="slide level2">
<h2>Parameters that depend on parameters</h2>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>With mlm we treated means as coming from a population of means. And thus there was a best guess of the mean (intercept) and variation around that guess (SD). With anova we ignored the variation. But we could, in bayes, still examine that variation. Lets fit an index model, where each person gets a mean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>mlm<span class="sc">$</span>ID.f <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mlm<span class="sc">$</span>ID)</span>
<span id="cb19-2"><a href="#cb19-2"></a>mlm.id <span class="ot">&lt;-</span> </span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb19-4"><a href="#cb19-4"></a>      CON <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> ID.f ,</span>
<span id="cb19-5"><a href="#cb19-5"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb19-6"><a href="#cb19-6"></a>      <span class="at">data =</span> mlm, </span>
<span id="cb19-7"><a href="#cb19-7"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb19-8"><a href="#cb19-8"></a>      <span class="at">file =</span> <span class="st">"mlm.id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>This is similar to a “fixed effect” model, something that is popular in econometrics. It, in contrast to the random effect model, does not model random effects.</p>
<p>Why do we want to model random effects? Variance decomposition which leads to increased power.</p>
<p>Also, 1. we can include group/cluster level predictors, which fixed effect cannot. 2. it makes an assumption about whether the clusters are random or not. Psych they are almost always random (people, site, orgs) whereas for econometrics they aren’t (country, state).</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">summary</span>(mlm.id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 0 + ID.f 
   Data: mlm (Number of observations: 225) 
  Draws: 2 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 6000

Regression Coefficients:
        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
ID.f6       0.19      0.03     0.13     0.25 1.00    10924     3696
ID.f29      0.12      0.03     0.06     0.19 1.00     9118     4858
ID.f34      0.11      0.03     0.04     0.17 1.00     9838     4057
ID.f36      0.16      0.03     0.09     0.23 1.00     9798     4244
ID.f37      0.19      0.03     0.13     0.24 1.00     7867     4261
ID.f48      0.22      0.03     0.16     0.27 1.00    10144     4439
ID.f53      0.19      0.03     0.12     0.26 1.00    10557     4631
ID.f54      0.24      0.03     0.19     0.30 1.00     8629     4163
ID.f58      0.23      0.03     0.18     0.29 1.00    10315     4384
ID.f61      0.09      0.03     0.02     0.15 1.00     9320     4228
ID.f66      0.24      0.03     0.18     0.29 1.00     8576     4507
ID.f67      0.20      0.02     0.15     0.25 1.00    10307     4290
ID.f69      0.21      0.03     0.14     0.27 1.00     8653     4040
ID.f71      0.06      0.03     0.01     0.11 1.00     7862     4688
ID.f74      0.20      0.03     0.15     0.26 1.00     9842     4185
ID.f75      0.27      0.03     0.21     0.34 1.00     9410     4550
ID.f76      0.10      0.03     0.04     0.15 1.00     9381     3719
ID.f78      0.25      0.03     0.19     0.30 1.00     9223     4485
ID.f79      0.13      0.03     0.06     0.20 1.00    10651     4380
ID.f80      0.14      0.03     0.07     0.21 1.00     8803     3909
ID.f81      0.24      0.03     0.19     0.29 1.00    10760     3948
ID.f82      0.33      0.02     0.28     0.37 1.00     9687     4371
ID.f85      0.16      0.03     0.09     0.22 1.00    10246     4192
ID.f86      0.12      0.03     0.05     0.18 1.00     9680     4230
ID.f87      0.11      0.03     0.05     0.17 1.00    10253     4542
ID.f89      0.14      0.03     0.08     0.19 1.00    11259     4270
ID.f91      0.17      0.03     0.12     0.23 1.00     7766     4474
ID.f92      0.20      0.03     0.15     0.26 1.00     8776     4385
ID.f93      0.25      0.03     0.20     0.31 1.00     8575     4257
ID.f94      0.12      0.03     0.07     0.17 1.00     8959     4182
ID.f96      0.23      0.03     0.17     0.30 1.00    10164     4151
ID.f97      0.25      0.02     0.20     0.29 1.00     9816     3991
ID.f98      0.14      0.02     0.09     0.19 1.00     8659     4126
ID.f99      0.18      0.02     0.13     0.23 1.00     9669     3954
ID.f101     0.25      0.03     0.19     0.30 1.00    10001     4066
ID.f102     0.19      0.02     0.14     0.24 1.00     9703     3888
ID.f103     0.15      0.03     0.09     0.22 1.00     9353     3941
ID.f104     0.17      0.03     0.11     0.24 1.00     8637     4350
ID.f105     0.16      0.03     0.11     0.22 1.00     9213     3772
ID.f106     0.20      0.03     0.14     0.25 1.00     9950     4388
ID.f110     0.18      0.03     0.13     0.23 1.00     8712     4395
ID.f112     0.09      0.03     0.04     0.15 1.00     9954     4478
ID.f114     0.13      0.03     0.08     0.19 1.00    10938     4131
ID.f115     0.14      0.03     0.09     0.20 1.00     9488     4599
ID.f116     0.14      0.03     0.09     0.20 1.00    10366     4372
ID.f120     0.35      0.03     0.29     0.42 1.00     9298     3807
ID.f122     0.17      0.03     0.12     0.22 1.00    11020     4272
ID.f125     0.20      0.03     0.14     0.25 1.00     9336     4267
ID.f127     0.23      0.03     0.17     0.28 1.00     9474     4524
ID.f129     0.13      0.03     0.06     0.20 1.00    12581     4027
ID.f135     0.30      0.03     0.24     0.35 1.00     9638     4229
ID.f136     0.29      0.03     0.24     0.34 1.00    10695     4402
ID.f137     0.29      0.03     0.23     0.36 1.00     8942     4181
ID.f140     0.13      0.03     0.06     0.19 1.00     8470     4316
ID.f141     0.19      0.03     0.13     0.26 1.00     9389     4196
ID.f142     0.18      0.03     0.11     0.24 1.00    10253     3800
ID.f143     0.31      0.03     0.25     0.38 1.00    10054     3865
ID.f144     0.17      0.03     0.11     0.24 1.00     7105     4359
ID.f146     0.21      0.03     0.14     0.28 1.00     9564     3766
ID.f149     0.23      0.03     0.16     0.30 1.00    10981     3875
ID.f150     0.20      0.03     0.13     0.27 1.00    10083     3732
ID.f152     0.22      0.03     0.16     0.29 1.00     9769     3841
ID.f153     0.15      0.03     0.08     0.21 1.00     9864     4201
ID.f155     0.14      0.03     0.08     0.21 1.00    10010     4122
ID.f156     0.14      0.03     0.08     0.19 1.00    11558     4147
ID.f159     0.12      0.03     0.06     0.19 1.00     9704     4022
ID.f160     0.18      0.03     0.11     0.24 1.00     8643     3855
ID.f162     0.39      0.03     0.34     0.45 1.00     9210     4318
ID.f163     0.13      0.03     0.07     0.20 1.00     9529     4130
ID.f165     0.20      0.03     0.13     0.26 1.00     9787     4099
ID.f167     0.13      0.03     0.07     0.20 1.00     9169     4571
ID.f169     0.24      0.03     0.18     0.31 1.00     8591     4415
ID.f171     0.23      0.03     0.16     0.29 1.00     9039     4176
ID.f174     0.26      0.03     0.20     0.33 1.00     9751     4180
ID.f182     0.19      0.03     0.12     0.25 1.00     8801     4093
ID.f187     0.06      0.03    -0.00     0.13 1.00     9681     4140
ID.f189     0.22      0.03     0.15     0.29 1.00     7780     4111
ID.f190     0.13      0.03     0.06     0.19 1.00     9980     4381
ID.f193     0.21      0.03     0.14     0.27 1.00     9616     4207
ID.f194     0.12      0.03     0.05     0.18 1.00    10107     4273
ID.f201     0.19      0.03     0.12     0.25 1.00    10278     4100
ID.f204     0.29      0.03     0.22     0.35 1.00     8399     4322
ID.f205     0.19      0.03     0.13     0.26 1.00     9627     4526
ID.f208     0.20      0.03     0.14     0.27 1.00    11281     4034
ID.f209     0.21      0.03     0.14     0.28 1.00    10907     4106
ID.f211     0.14      0.03     0.07     0.21 1.00     9153     4547
ID.f214     0.28      0.03     0.21     0.34 1.00     9734     4248
ID.f219     0.23      0.03     0.16     0.30 1.00    10046     3937
ID.f222     0.14      0.03     0.07     0.20 1.00     9970     4305
ID.f223     0.17      0.03     0.10     0.23 1.00    10288     4224
ID.f229     0.14      0.03     0.08     0.21 1.00    10279     4164

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     3686     4264

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">posterior_samples</span>(mlm.id) <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">pivot_longer</span>(b_ID.f6<span class="sc">:</span>b_ID.f91, <span class="at">names_to=</span><span class="st">"ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(value), <span class="at">sd=</span><span class="fu">sd</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
   mean     sd
  &lt;dbl&gt;  &lt;dbl&gt;
1 0.178 0.0697</code></pre>
</div>
</div>
</section>
<section id="partial-poolingshrinkage" class="slide level2">
<h2>Partial pooling/Shrinkage</h2>
<p><span class="math inline">\(\sigma_0\)</span> (our random effect) can help turn on/off/adjust shrinkage.</p>
<p>Setting SD to zero says everyone is the same. Infinite SD suggests no pooling (and major differences in pop values). In the middle gives you partial pooling.</p>
<p>We use our prior of <span class="math inline">\(\sigma_0\)</span> plus our data to get an estimate of <span class="math inline">\(\beta_{0[j]}\)</span>. This is how we accurately partial pool.</p>
</section>
<section id="partial-poolingshrinkage-1" class="slide level2">
<h2>Partial pooling/Shrinkage</h2>
<p><span class="math display">\[\text{y}_{ij}  \sim \operatorname{Normal}(\mu_i, \sigma_i)\]</span></p>
<p><span class="math display">\[\mu_i  = \beta_{0[i]}\]</span></p>
<p><span class="math display">\[\beta_{0[i]} \sim \operatorname{Normal}({\bar \mu},  \sigma_0)\]</span> <span class="math display">\[{\bar \mu}  \sim {\operatorname{Normal}(0, 1.5)}\]</span></p>
<p><span class="math display">\[\sigma_0 \sim {\operatorname{Normal}(0, 1.5)}\]</span></p>
<p><span class="math display">\[\sigma \sim {\operatorname{Exponential}(1)}\]</span></p>
</section>
<section id="working-with-mlm-posterior" class="slide level2">
<h2>working with mlm posterior</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">summary</span>(mlm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 5000; warmup = 1000; thin = 1;
         total post-warmup draws = 16000

Multilevel Hyperparameters:
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.06      0.01     0.05     0.07 1.00     5761     8415

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.01     0.18     0.20 1.00     8349    10553

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00    10318    12737

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="fu">get_variables</span>(mlm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "b_Intercept"         "sd_ID__Intercept"    "sigma"              
  [4] "Intercept"           "r_ID[6,Intercept]"   "r_ID[29,Intercept]" 
  [7] "r_ID[34,Intercept]"  "r_ID[36,Intercept]"  "r_ID[37,Intercept]" 
 [10] "r_ID[48,Intercept]"  "r_ID[53,Intercept]"  "r_ID[54,Intercept]" 
 [13] "r_ID[58,Intercept]"  "r_ID[61,Intercept]"  "r_ID[66,Intercept]" 
 [16] "r_ID[67,Intercept]"  "r_ID[69,Intercept]"  "r_ID[71,Intercept]" 
 [19] "r_ID[74,Intercept]"  "r_ID[75,Intercept]"  "r_ID[76,Intercept]" 
 [22] "r_ID[78,Intercept]"  "r_ID[79,Intercept]"  "r_ID[80,Intercept]" 
 [25] "r_ID[81,Intercept]"  "r_ID[82,Intercept]"  "r_ID[85,Intercept]" 
 [28] "r_ID[86,Intercept]"  "r_ID[87,Intercept]"  "r_ID[89,Intercept]" 
 [31] "r_ID[91,Intercept]"  "r_ID[92,Intercept]"  "r_ID[93,Intercept]" 
 [34] "r_ID[94,Intercept]"  "r_ID[96,Intercept]"  "r_ID[97,Intercept]" 
 [37] "r_ID[98,Intercept]"  "r_ID[99,Intercept]"  "r_ID[101,Intercept]"
 [40] "r_ID[102,Intercept]" "r_ID[103,Intercept]" "r_ID[104,Intercept]"
 [43] "r_ID[105,Intercept]" "r_ID[106,Intercept]" "r_ID[110,Intercept]"
 [46] "r_ID[112,Intercept]" "r_ID[114,Intercept]" "r_ID[115,Intercept]"
 [49] "r_ID[116,Intercept]" "r_ID[120,Intercept]" "r_ID[122,Intercept]"
 [52] "r_ID[125,Intercept]" "r_ID[127,Intercept]" "r_ID[129,Intercept]"
 [55] "r_ID[135,Intercept]" "r_ID[136,Intercept]" "r_ID[137,Intercept]"
 [58] "r_ID[140,Intercept]" "r_ID[141,Intercept]" "r_ID[142,Intercept]"
 [61] "r_ID[143,Intercept]" "r_ID[144,Intercept]" "r_ID[146,Intercept]"
 [64] "r_ID[149,Intercept]" "r_ID[150,Intercept]" "r_ID[152,Intercept]"
 [67] "r_ID[153,Intercept]" "r_ID[155,Intercept]" "r_ID[156,Intercept]"
 [70] "r_ID[159,Intercept]" "r_ID[160,Intercept]" "r_ID[162,Intercept]"
 [73] "r_ID[163,Intercept]" "r_ID[165,Intercept]" "r_ID[167,Intercept]"
 [76] "r_ID[169,Intercept]" "r_ID[171,Intercept]" "r_ID[174,Intercept]"
 [79] "r_ID[182,Intercept]" "r_ID[187,Intercept]" "r_ID[189,Intercept]"
 [82] "r_ID[190,Intercept]" "r_ID[193,Intercept]" "r_ID[194,Intercept]"
 [85] "r_ID[201,Intercept]" "r_ID[204,Intercept]" "r_ID[205,Intercept]"
 [88] "r_ID[208,Intercept]" "r_ID[209,Intercept]" "r_ID[211,Intercept]"
 [91] "r_ID[214,Intercept]" "r_ID[219,Intercept]" "r_ID[222,Intercept]"
 [94] "r_ID[223,Intercept]" "r_ID[229,Intercept]" "prior_Intercept"    
 [97] "prior_sigma"         "prior_sd_ID"         "lprior"             
[100] "lp__"                "accept_stat__"       "treedepth__"        
[103] "stepsize__"          "divergent__"         "n_leapfrog__"       
[106] "energy__"           </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID, term]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,456,000 × 6
# Groups:   ID, term [91]
      ID term          r_ID .chain .iteration .draw
   &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
 1     6 Intercept  0.0133       1          1     1
 2     6 Intercept -0.00438      1          2     2
 3     6 Intercept  0.0214       1          3     3
 4     6 Intercept  0.00738      1          4     4
 5     6 Intercept -0.0173       1          5     5
 6     6 Intercept -0.0386       1          6     6
 7     6 Intercept  0.0233       1          7     7
 8     6 Intercept -0.0351       1          8     8
 9     6 Intercept  0.0346       1          9     9
10     6 Intercept -0.0349       1         10    10
# ℹ 1,455,990 more rows</code></pre>
</div>
</div>
<p>16000 samples (4 chains * 4k iterations) * 91 people</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,456,000 × 5
# Groups:   ID [91]
      ID     r_ID .chain .iteration .draw
   &lt;int&gt;    &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
 1     6  0.0133       1          1     1
 2     6 -0.00438      1          2     2
 3     6  0.0214       1          3     3
 4     6  0.00738      1          4     4
 5     6 -0.0173       1          5     5
 6     6 -0.0386       1          6     6
 7     6  0.0233       1          7     7
 8     6 -0.0351       1          8     8
 9     6  0.0346       1          9     9
10     6 -0.0349       1         10    10
# ℹ 1,455,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3"></a> <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 91 × 8
      ID term           r_ID   .lower   .upper .width .point .interval
   &lt;int&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
 1     6 Intercept  0.000562 -0.0491   0.0504    0.95 median qi       
 2    29 Intercept -0.0479   -0.106    0.0101    0.95 median qi       
 3    34 Intercept -0.0614   -0.118   -0.00512   0.95 median qi       
 4    36 Intercept -0.0219   -0.0784   0.0347    0.95 median qi       
 5    37 Intercept -0.00311  -0.0523   0.0464    0.95 median qi       
 6    48 Intercept  0.0238   -0.0266   0.0727    0.95 median qi       
 7    53 Intercept  0.000709 -0.0557   0.0567    0.95 median qi       
 8    54 Intercept  0.0454   -0.00412  0.0944    0.95 median qi       
 9    58 Intercept  0.0369   -0.0122   0.0861    0.95 median qi       
10    61 Intercept -0.0749   -0.133   -0.0166    0.95 median qi       
# ℹ 81 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">left_join</span>(mlm <span class="sc">%&gt;%</span> <span class="fu">select</span> (ID, CON) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">CON =</span> <span class="fu">mean</span>(CON))) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4"></a> <span class="fu">median_qi</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ID)) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> r_ID), <span class="at">color =</span> <span class="st">"orange2"</span>) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8"></a>  <span class="fu">labs</span>(<span class="at">title =</span>  </span>
<span id="cb34-9"><a href="#cb34-9"></a>  <span class="st">"orange is model based, black circles are observed means"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-30-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Think back to {lme4} and <code>ranef</code> <code>coef</code> and <code>fixef</code> functions.</p>
<p>What do each of these describe?</p>
<p>What scale is our random effect (typically) in?</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,456,000 × 7
# Groups:   ID, term [91]
   .chain .iteration .draw b_Intercept    ID term          r_ID
    &lt;int&gt;      &lt;int&gt; &lt;int&gt;       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
 1      1          1     1       0.189     6 Intercept  0.0133 
 2      1          1     1       0.189    29 Intercept -0.0511 
 3      1          1     1       0.189    34 Intercept -0.0897 
 4      1          1     1       0.189    36 Intercept -0.0200 
 5      1          1     1       0.189    37 Intercept  0.0412 
 6      1          1     1       0.189    48 Intercept  0.0104 
 7      1          1     1       0.189    53 Intercept  0.0844 
 8      1          1     1       0.189    54 Intercept -0.00270
 9      1          1     1       0.189    58 Intercept  0.0389 
10      1          1     1       0.189    61 Intercept -0.0712 
# ℹ 1,455,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3"></a>   <span class="fu">mutate</span>(<span class="at">person_I =</span> b_Intercept <span class="sc">+</span> r_ID) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,456,000 × 8
# Groups:   ID, term [91]
   .chain .iteration .draw b_Intercept    ID term          r_ID person_I
    &lt;int&gt;      &lt;int&gt; &lt;int&gt;       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;
 1      1          1     1       0.189     6 Intercept  0.0133    0.203 
 2      1          1     1       0.189    29 Intercept -0.0511    0.138 
 3      1          1     1       0.189    34 Intercept -0.0897    0.0997
 4      1          1     1       0.189    36 Intercept -0.0200    0.169 
 5      1          1     1       0.189    37 Intercept  0.0412    0.230 
 6      1          1     1       0.189    48 Intercept  0.0104    0.200 
 7      1          1     1       0.189    53 Intercept  0.0844    0.274 
 8      1          1     1       0.189    54 Intercept -0.00270   0.187 
 9      1          1     1       0.189    58 Intercept  0.0389    0.228 
10      1          1     1       0.189    61 Intercept -0.0712    0.118 
# ℹ 1,455,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>  <span class="fu">mutate</span>(<span class="at">person_I =</span> b_Intercept <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>  <span class="fu">left_join</span>(mlm <span class="sc">%&gt;%</span> <span class="fu">select</span> (ID, CON) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">CON =</span> <span class="fu">mean</span>(CON))) <span class="sc">%&gt;%</span> </span>
<span id="cb39-5"><a href="#cb39-5"></a> <span class="fu">median_qi</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ID)) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> person_I), <span class="at">color =</span> <span class="st">"orange2"</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9"></a>  <span class="fu">labs</span>(<span class="at">title =</span>  </span>
<span id="cb39-10"><a href="#cb39-10"></a>  <span class="st">"orange is model based, black circles are observed means"</span>) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span><span class="fl">0.1849846</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>mlm<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>   <span class="fu">median_qi</span>(<span class="at">person_I =</span> b_Intercept <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">y =</span> <span class="fu">reorder</span>(ID, person_I), <span class="at">x =</span> person_I, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>  <span class="fu">geom_pointinterval</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"est"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Set prior for random effect to almost zero for complete pooling.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>mlm<span class="fl">.1</span>p <span class="ot">&lt;-</span> </span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb41-3"><a href="#cb41-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb41-4"><a href="#cb41-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb41-5"><a href="#cb41-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, .<span class="dv">00001</span>), <span class="at">class =</span> sd), </span>
<span id="cb41-6"><a href="#cb41-6"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb41-7"><a href="#cb41-7"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb41-8"><a href="#cb41-8"></a>      <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<span id="cb41-9"><a href="#cb41-9"></a>      <span class="at">file =</span> <span class="st">"mlm.1p"</span>,</span>
<span id="cb41-10"><a href="#cb41-10"></a>       <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb41-11"><a href="#cb41-11"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">summary</span>(mlm<span class="fl">.1</span>p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Multilevel Hyperparameters:
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.00      0.00     0.00     0.00 1.00     8952     6581

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.00     0.18     0.20 1.00    19393     8474

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.07      0.00     0.07     0.08 1.00    21537     7644

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>mlm<span class="fl">.1</span>p <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="fu">spread_draws</span>(b_Intercept, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="fu">mutate</span>(<span class="at">person_I =</span> b_Intercept <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>  <span class="fu">left_join</span>(mlm <span class="sc">%&gt;%</span> <span class="fu">select</span> (ID, CON) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">CON =</span> <span class="fu">mean</span>(CON))) <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5"></a> <span class="fu">median_qi</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ID)) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> person_I), <span class="at">color =</span> <span class="st">"orange2"</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>  <span class="fu">labs</span>(<span class="at">title =</span>  </span>
<span id="cb44-10"><a href="#cb44-10"></a>  <span class="st">"complete pooling"</span>) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span><span class="fl">0.189846</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-37-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>No pooling means you are not learning from other data, which is by default not an MLM model. We already fit this fixed effects no intercept model above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">summary</span>(mlm.id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 0 + ID.f 
   Data: mlm (Number of observations: 225) 
  Draws: 2 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 6000

Regression Coefficients:
        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
ID.f6       0.19      0.03     0.13     0.25 1.00    10924     3696
ID.f29      0.12      0.03     0.06     0.19 1.00     9118     4858
ID.f34      0.11      0.03     0.04     0.17 1.00     9838     4057
ID.f36      0.16      0.03     0.09     0.23 1.00     9798     4244
ID.f37      0.19      0.03     0.13     0.24 1.00     7867     4261
ID.f48      0.22      0.03     0.16     0.27 1.00    10144     4439
ID.f53      0.19      0.03     0.12     0.26 1.00    10557     4631
ID.f54      0.24      0.03     0.19     0.30 1.00     8629     4163
ID.f58      0.23      0.03     0.18     0.29 1.00    10315     4384
ID.f61      0.09      0.03     0.02     0.15 1.00     9320     4228
ID.f66      0.24      0.03     0.18     0.29 1.00     8576     4507
ID.f67      0.20      0.02     0.15     0.25 1.00    10307     4290
ID.f69      0.21      0.03     0.14     0.27 1.00     8653     4040
ID.f71      0.06      0.03     0.01     0.11 1.00     7862     4688
ID.f74      0.20      0.03     0.15     0.26 1.00     9842     4185
ID.f75      0.27      0.03     0.21     0.34 1.00     9410     4550
ID.f76      0.10      0.03     0.04     0.15 1.00     9381     3719
ID.f78      0.25      0.03     0.19     0.30 1.00     9223     4485
ID.f79      0.13      0.03     0.06     0.20 1.00    10651     4380
ID.f80      0.14      0.03     0.07     0.21 1.00     8803     3909
ID.f81      0.24      0.03     0.19     0.29 1.00    10760     3948
ID.f82      0.33      0.02     0.28     0.37 1.00     9687     4371
ID.f85      0.16      0.03     0.09     0.22 1.00    10246     4192
ID.f86      0.12      0.03     0.05     0.18 1.00     9680     4230
ID.f87      0.11      0.03     0.05     0.17 1.00    10253     4542
ID.f89      0.14      0.03     0.08     0.19 1.00    11259     4270
ID.f91      0.17      0.03     0.12     0.23 1.00     7766     4474
ID.f92      0.20      0.03     0.15     0.26 1.00     8776     4385
ID.f93      0.25      0.03     0.20     0.31 1.00     8575     4257
ID.f94      0.12      0.03     0.07     0.17 1.00     8959     4182
ID.f96      0.23      0.03     0.17     0.30 1.00    10164     4151
ID.f97      0.25      0.02     0.20     0.29 1.00     9816     3991
ID.f98      0.14      0.02     0.09     0.19 1.00     8659     4126
ID.f99      0.18      0.02     0.13     0.23 1.00     9669     3954
ID.f101     0.25      0.03     0.19     0.30 1.00    10001     4066
ID.f102     0.19      0.02     0.14     0.24 1.00     9703     3888
ID.f103     0.15      0.03     0.09     0.22 1.00     9353     3941
ID.f104     0.17      0.03     0.11     0.24 1.00     8637     4350
ID.f105     0.16      0.03     0.11     0.22 1.00     9213     3772
ID.f106     0.20      0.03     0.14     0.25 1.00     9950     4388
ID.f110     0.18      0.03     0.13     0.23 1.00     8712     4395
ID.f112     0.09      0.03     0.04     0.15 1.00     9954     4478
ID.f114     0.13      0.03     0.08     0.19 1.00    10938     4131
ID.f115     0.14      0.03     0.09     0.20 1.00     9488     4599
ID.f116     0.14      0.03     0.09     0.20 1.00    10366     4372
ID.f120     0.35      0.03     0.29     0.42 1.00     9298     3807
ID.f122     0.17      0.03     0.12     0.22 1.00    11020     4272
ID.f125     0.20      0.03     0.14     0.25 1.00     9336     4267
ID.f127     0.23      0.03     0.17     0.28 1.00     9474     4524
ID.f129     0.13      0.03     0.06     0.20 1.00    12581     4027
ID.f135     0.30      0.03     0.24     0.35 1.00     9638     4229
ID.f136     0.29      0.03     0.24     0.34 1.00    10695     4402
ID.f137     0.29      0.03     0.23     0.36 1.00     8942     4181
ID.f140     0.13      0.03     0.06     0.19 1.00     8470     4316
ID.f141     0.19      0.03     0.13     0.26 1.00     9389     4196
ID.f142     0.18      0.03     0.11     0.24 1.00    10253     3800
ID.f143     0.31      0.03     0.25     0.38 1.00    10054     3865
ID.f144     0.17      0.03     0.11     0.24 1.00     7105     4359
ID.f146     0.21      0.03     0.14     0.28 1.00     9564     3766
ID.f149     0.23      0.03     0.16     0.30 1.00    10981     3875
ID.f150     0.20      0.03     0.13     0.27 1.00    10083     3732
ID.f152     0.22      0.03     0.16     0.29 1.00     9769     3841
ID.f153     0.15      0.03     0.08     0.21 1.00     9864     4201
ID.f155     0.14      0.03     0.08     0.21 1.00    10010     4122
ID.f156     0.14      0.03     0.08     0.19 1.00    11558     4147
ID.f159     0.12      0.03     0.06     0.19 1.00     9704     4022
ID.f160     0.18      0.03     0.11     0.24 1.00     8643     3855
ID.f162     0.39      0.03     0.34     0.45 1.00     9210     4318
ID.f163     0.13      0.03     0.07     0.20 1.00     9529     4130
ID.f165     0.20      0.03     0.13     0.26 1.00     9787     4099
ID.f167     0.13      0.03     0.07     0.20 1.00     9169     4571
ID.f169     0.24      0.03     0.18     0.31 1.00     8591     4415
ID.f171     0.23      0.03     0.16     0.29 1.00     9039     4176
ID.f174     0.26      0.03     0.20     0.33 1.00     9751     4180
ID.f182     0.19      0.03     0.12     0.25 1.00     8801     4093
ID.f187     0.06      0.03    -0.00     0.13 1.00     9681     4140
ID.f189     0.22      0.03     0.15     0.29 1.00     7780     4111
ID.f190     0.13      0.03     0.06     0.19 1.00     9980     4381
ID.f193     0.21      0.03     0.14     0.27 1.00     9616     4207
ID.f194     0.12      0.03     0.05     0.18 1.00    10107     4273
ID.f201     0.19      0.03     0.12     0.25 1.00    10278     4100
ID.f204     0.29      0.03     0.22     0.35 1.00     8399     4322
ID.f205     0.19      0.03     0.13     0.26 1.00     9627     4526
ID.f208     0.20      0.03     0.14     0.27 1.00    11281     4034
ID.f209     0.21      0.03     0.14     0.28 1.00    10907     4106
ID.f211     0.14      0.03     0.07     0.21 1.00     9153     4547
ID.f214     0.28      0.03     0.21     0.34 1.00     9734     4248
ID.f219     0.23      0.03     0.16     0.30 1.00    10046     3937
ID.f222     0.14      0.03     0.07     0.20 1.00     9970     4305
ID.f223     0.17      0.03     0.10     0.23 1.00    10288     4224
ID.f229     0.14      0.03     0.08     0.21 1.00    10279     4164

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     3686     4264

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>data2<span class="ot">&lt;-</span>mlm <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, CON) <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3"></a>  <span class="fu">mutate</span>(<span class="at">CON =</span> <span class="fu">mean</span>(CON)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href="#cb47-4"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb47-5"><a href="#cb47-5"></a></span>
<span id="cb47-6"><a href="#cb47-6"></a>mlm.id <span class="sc">%&gt;%</span> <span class="fu">tidy_draws</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-7"><a href="#cb47-7"></a>  <span class="fu">pivot_longer</span>(b_ID.f6<span class="sc">:</span>b_ID.f229, <span class="at">names_to =</span> <span class="st">"ID"</span>, <span class="at">values_to =</span> <span class="st">"CON_I"</span>, <span class="at">names_prefix =</span> <span class="st">"b_ID.f"</span>, <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">ID =</span> as.integer)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="fu">left_join</span>(data2) <span class="sc">%&gt;%</span> </span>
<span id="cb47-9"><a href="#cb47-9"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb47-10"><a href="#cb47-10"></a>   <span class="fu">median_qi</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-11"><a href="#cb47-11"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ID)) <span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON_I), <span class="at">color =</span> <span class="st">"orange2"</span>) <span class="sc">+</span></span>
<span id="cb47-13"><a href="#cb47-13"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> CON), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb47-14"><a href="#cb47-14"></a>  <span class="fu">labs</span>(<span class="at">title =</span>  </span>
<span id="cb47-15"><a href="#cb47-15"></a>  <span class="st">"NO pooling"</span>) <span class="sc">+</span></span>
<span id="cb47-16"><a href="#cb47-16"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span><span class="fl">0.1849846</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-39-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>MLM will automatically create the best fitting model – balancing between over and under fitting. It identifies the value of sigma of the random effect that is ideal.</p>
<p>This “knob” can be manually turned to different values and we can look at the fit of the model via loo or wais. But we dont need to!</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>mlm.id <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm.id, <span class="st">"loo"</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a>mlm<span class="fl">.1</span>p <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.1</span>p, <span class="st">"loo"</span>)</span>
<span id="cb48-3"><a href="#cb48-3"></a>mlm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.1</span>, <span class="st">"loo"</span>)</span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="fu">loo_compare</span>(mlm.id, mlm<span class="fl">.1</span>p, mlm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       elpd_diff se_diff
mlm.1    0.0       0.0  
mlm.id -15.3       5.7  
mlm.1p -58.2       8.9  </code></pre>
</div>
</div>
</section>
<section id="level-1-predictors-1" class="slide level2">
<h2>level 1 predictors</h2>
<p><span class="math display">\[\text{y}_{ij}  \sim \operatorname{Normal}(\mu_i, \sigma)\]</span> <span class="math display">\[\mu_{ij}  = \beta_{0[i]} + \beta_{1[i]}Time_{ij}\]</span></p>
<p><span class="math display">\[\beta_{0[i]} \sim \operatorname{Normal}({\bar \mu}, \sigma_0)\]</span> <span class="math display">\[{\bar \mu}  \sim {\operatorname{Normal}(0, 1.5)}\]</span> <span class="math display">\[\sigma_0 \sim {\operatorname{Exponential}(1)}\]</span> <span class="math display">\[\beta_{1[i]} \sim {\operatorname{Normal}(0, 1.5)}\]</span> <span class="math display">\[\sigma \sim {\operatorname{Exponential}(1)}\]</span></p>
</section>
<section class="slide level2">

<p>Notice how the slope variable was not a hyper prior. What does that mean? That means it is not random. People can still differ, but only based on the equation we set up for it. That is, there are fixed effects based on different gammas, but not Us to represent random variation. To do so we would need a parameter for that, and we dont have it.</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>mlm<span class="fl">.3</span> <span class="ot">&lt;-</span> </span>
<span id="cb50-2"><a href="#cb50-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb50-3"><a href="#cb50-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb50-4"><a href="#cb50-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb50-5"><a href="#cb50-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> b),</span>
<span id="cb50-6"><a href="#cb50-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sd), </span>
<span id="cb50-7"><a href="#cb50-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb50-8"><a href="#cb50-8"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb50-9"><a href="#cb50-9"></a>      <span class="at">sample_prior =</span> <span class="st">"yes"</span>,</span>
<span id="cb50-10"><a href="#cb50-10"></a>      <span class="at">file =</span> <span class="st">"mlm.3"</span>,</span>
<span id="cb50-11"><a href="#cb50-11"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb50-12"><a href="#cb50-12"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">summary</span>(mlm<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + time + (1 | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Multilevel Hyperparameters:
~ID (Number of levels: 91) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.06      0.01     0.05     0.07 1.00     4193     7476

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.01     0.18     0.21 1.00     6994     8994
time         -0.00      0.00    -0.01     0.00 1.00    14742     9789

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     8013     9414

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">posterior_summary</span>(mlm<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Estimate    Est.Error          Q2.5         Q97.5
b_Intercept          1.940041e-01  0.007826677  1.786149e-01   0.209344725
b_time              -2.643092e-03  0.002177587 -6.925225e-03   0.001649079
sd_ID__Intercept     5.649883e-02  0.005517628  4.631454e-02   0.067848202
sigma                4.734761e-02  0.002936514  4.202114e-02   0.053612102
Intercept            1.892113e-01  0.006815445  1.758717e-01   0.202529600
r_ID[6,Intercept]    6.894050e-03  0.025632477 -4.255819e-02   0.057214167
r_ID[29,Intercept]  -4.317045e-02  0.029410532 -1.006675e-01   0.014857105
r_ID[34,Intercept]  -5.496105e-02  0.029746469 -1.128902e-01   0.004024982
r_ID[36,Intercept]  -2.075095e-02  0.029930676 -7.989738e-02   0.037928447
r_ID[37,Intercept]   2.959034e-03  0.025584463 -4.766372e-02   0.053536242
r_ID[48,Intercept]   2.934054e-02  0.025564624 -2.058067e-02   0.079359287
r_ID[53,Intercept]   5.540256e-03  0.029425227 -5.144062e-02   0.062757537
r_ID[54,Intercept]   4.985518e-02  0.025833256 -6.674044e-04   0.100699050
r_ID[58,Intercept]   3.808043e-02  0.025174264 -1.137551e-02   0.088185725
r_ID[61,Intercept]  -6.931222e-02  0.030108863 -1.272552e-01  -0.009055818
r_ID[66,Intercept]   4.185027e-02  0.026067018 -9.074979e-03   0.092666637
r_ID[67,Intercept]   1.223557e-02  0.022633214 -3.214001e-02   0.056104997
r_ID[69,Intercept]   1.226932e-02  0.029667775 -4.596177e-02   0.071293052
r_ID[71,Intercept]  -1.049470e-01  0.025777505 -1.555616e-01  -0.053859977
r_ID[74,Intercept]   1.413066e-02  0.025052025 -3.610169e-02   0.063177775
r_ID[75,Intercept]   5.966435e-02  0.029682943  9.122672e-04   0.117949300
r_ID[76,Intercept]  -7.273943e-02  0.025845048 -1.237458e-01  -0.021956278
r_ID[78,Intercept]   4.721165e-02  0.025409451 -2.031112e-03   0.096977370
r_ID[79,Intercept]  -4.323185e-02  0.028792257 -9.884914e-02   0.012840262
r_ID[80,Intercept]  -3.360304e-02  0.029631554 -9.249670e-02   0.024892937
r_ID[81,Intercept]   4.425246e-02  0.025313321 -5.117839e-03   0.093899587
r_ID[82,Intercept]   1.194751e-01  0.023401803  7.375427e-02   0.165049050
r_ID[85,Intercept]  -2.656583e-02  0.029255811 -8.330911e-02   0.031289555
r_ID[86,Intercept]  -5.658335e-02  0.029450409 -1.140732e-01   0.001370705
r_ID[87,Intercept]  -5.910435e-02  0.029014664 -1.155641e-01  -0.002082889
r_ID[89,Intercept]  -4.504349e-02  0.025147000 -9.468816e-02   0.004342086
r_ID[91,Intercept]  -1.497194e-02  0.025330625 -6.443315e-02   0.034996730
r_ID[92,Intercept]   9.446729e-03  0.025267257 -4.043862e-02   0.058558775
r_ID[93,Intercept]   5.056990e-02  0.024888297  1.763072e-03   0.099418635
r_ID[94,Intercept]  -5.880935e-02  0.025335247 -1.084745e-01  -0.008453616
r_ID[96,Intercept]   2.833736e-02  0.029139238 -2.908832e-02   0.084802120
r_ID[97,Intercept]   4.918658e-02  0.022604557  4.755043e-03   0.093747605
r_ID[98,Intercept]  -4.283807e-02  0.022794542 -8.700858e-02   0.001808808
r_ID[99,Intercept]  -6.916184e-03  0.022416641 -5.110949e-02   0.036865817
r_ID[101,Intercept]  4.376512e-02  0.025457997 -5.879864e-03   0.093417747
r_ID[102,Intercept] -2.004694e-03  0.022524556 -4.581805e-02   0.042389705
r_ID[103,Intercept] -2.816223e-02  0.028814760 -8.433012e-02   0.028689640
r_ID[104,Intercept] -1.368979e-02  0.028809435 -7.062960e-02   0.043247127
r_ID[105,Intercept] -2.319347e-02  0.025247822 -7.279866e-02   0.026286165
r_ID[106,Intercept]  5.606195e-03  0.025438938 -4.396306e-02   0.055691857
r_ID[110,Intercept] -6.040176e-03  0.025358673 -5.521733e-02   0.043524717
r_ID[112,Intercept] -7.817622e-02  0.025361370 -1.279663e-01  -0.028702283
r_ID[114,Intercept] -4.693322e-02  0.025277165 -9.660709e-02   0.002394822
r_ID[115,Intercept] -3.974349e-02  0.025565576 -8.929331e-02   0.009810768
r_ID[116,Intercept] -3.748329e-02  0.025295803 -8.713662e-02   0.011935252
r_ID[120,Intercept]  1.178859e-01  0.030366258  5.807562e-02   0.177008050
r_ID[122,Intercept] -1.668675e-02  0.024795466 -6.497346e-02   0.032179132
r_ID[125,Intercept]  3.978368e-03  0.024992491 -4.482118e-02   0.052190010
r_ID[127,Intercept]  2.903281e-02  0.025264905 -2.036774e-02   0.077879025
r_ID[129,Intercept] -4.621880e-02  0.029096849 -1.037195e-01   0.009960738
r_ID[135,Intercept]  8.624209e-02  0.025337232  3.609033e-02   0.135507875
r_ID[136,Intercept]  8.118360e-02  0.025158128  3.068991e-02   0.129971475
r_ID[137,Intercept]  7.377812e-02  0.029745954  1.539976e-02   0.131394075
r_ID[140,Intercept] -4.836868e-02  0.029448928 -1.060563e-01   0.009671810
r_ID[141,Intercept]  7.081259e-04  0.028982459 -5.557317e-02   0.057309203
r_ID[142,Intercept] -9.197605e-03  0.028776163 -6.584851e-02   0.047713220
r_ID[143,Intercept]  8.718954e-02  0.029738077  2.829227e-02   0.145901050
r_ID[144,Intercept] -1.220954e-02  0.028913189 -6.807766e-02   0.044226482
r_ID[146,Intercept]  1.452549e-02  0.029340069 -4.306062e-02   0.072288810
r_ID[149,Intercept]  2.789416e-02  0.029548885 -2.993960e-02   0.086790057
r_ID[150,Intercept]  8.209031e-03  0.028979915 -4.894788e-02   0.064855690
r_ID[152,Intercept]  2.224967e-02  0.029026980 -3.572727e-02   0.078511828
r_ID[153,Intercept] -3.240322e-02  0.029044160 -8.925863e-02   0.025473330
r_ID[155,Intercept] -3.428796e-02  0.029553408 -9.179035e-02   0.023144420
r_ID[156,Intercept] -4.425998e-02  0.024909364 -9.350289e-02   0.004300518
r_ID[159,Intercept] -5.022962e-02  0.029914616 -1.086059e-01   0.007938532
r_ID[160,Intercept] -1.053689e-02  0.029425129 -6.821577e-02   0.046206875
r_ID[162,Intercept]  1.633533e-01  0.026615499  1.104919e-01   0.215538275
r_ID[163,Intercept] -4.218590e-02  0.029002173 -9.878897e-02   0.015978262
r_ID[165,Intercept]  4.464695e-03  0.028710853 -5.227673e-02   0.059943440
r_ID[167,Intercept] -4.256251e-02  0.029661510 -1.005330e-01   0.015600112
r_ID[169,Intercept]  4.005395e-02  0.029386135 -1.658346e-02   0.097936420
r_ID[171,Intercept]  2.740331e-02  0.029132664 -2.948522e-02   0.084146590
r_ID[174,Intercept]  5.369041e-02  0.029363824 -4.309101e-03   0.110783450
r_ID[182,Intercept] -2.412529e-03  0.029420442 -6.034366e-02   0.055670132
r_ID[187,Intercept] -9.270728e-02  0.029389481 -1.513802e-01  -0.034574595
r_ID[189,Intercept]  2.329137e-02  0.029069868 -3.304641e-02   0.080815000
r_ID[190,Intercept] -4.737861e-02  0.029224274 -1.041065e-01   0.009797084
r_ID[193,Intercept]  1.154276e-02  0.029087872 -4.545133e-02   0.069312787
r_ID[194,Intercept] -5.155683e-02  0.029290674 -1.088242e-01   0.005207231
r_ID[201,Intercept] -2.345341e-03  0.028840586 -5.877458e-02   0.053656342
r_ID[204,Intercept]  7.145442e-02  0.029672124  1.284461e-02   0.129062150
r_ID[205,Intercept]  1.879642e-03  0.029138166 -5.530964e-02   0.059004535
r_ID[208,Intercept]  1.079179e-02  0.029439729 -4.773465e-02   0.068717263
r_ID[209,Intercept]  1.712446e-02  0.029112747 -3.961543e-02   0.073931125
r_ID[211,Intercept] -3.787819e-02  0.029070519 -9.520957e-02   0.019128560
r_ID[214,Intercept]  6.327564e-02  0.029131964  5.922527e-03   0.119764975
r_ID[219,Intercept]  3.069459e-02  0.028886861 -2.591263e-02   0.086664698
r_ID[222,Intercept] -3.944546e-02  0.029764179 -9.821513e-02   0.019382500
r_ID[223,Intercept] -1.704181e-02  0.028784857 -7.360138e-02   0.038043408
r_ID[229,Intercept] -3.656546e-02  0.029541925 -9.487947e-02   0.021016485
prior_Intercept     -6.942279e-03  1.503652694 -2.963533e+00   2.891599750
prior_b              1.858277e-03  1.502695245 -2.961395e+00   2.909511000
prior_sigma          1.009368e+00  1.010400540  2.450734e-02   3.710285250
prior_sd_ID          1.198032e+00  0.902823225  5.271736e-02   3.347677500
lprior              -3.336096e+00  0.002974311 -3.342360e+00  -3.330669750
lp__                 2.300110e+02 11.128664937  2.065509e+02 250.263325000</code></pre>
</div>
</div>
</section>
<section id="whats-in-our-posterior" class="slide level2">
<h2>whats in our posterior?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">get_variables</span>(mlm<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "b_Intercept"         "b_time"              "sd_ID__Intercept"   
  [4] "sigma"               "Intercept"           "r_ID[6,Intercept]"  
  [7] "r_ID[29,Intercept]"  "r_ID[34,Intercept]"  "r_ID[36,Intercept]" 
 [10] "r_ID[37,Intercept]"  "r_ID[48,Intercept]"  "r_ID[53,Intercept]" 
 [13] "r_ID[54,Intercept]"  "r_ID[58,Intercept]"  "r_ID[61,Intercept]" 
 [16] "r_ID[66,Intercept]"  "r_ID[67,Intercept]"  "r_ID[69,Intercept]" 
 [19] "r_ID[71,Intercept]"  "r_ID[74,Intercept]"  "r_ID[75,Intercept]" 
 [22] "r_ID[76,Intercept]"  "r_ID[78,Intercept]"  "r_ID[79,Intercept]" 
 [25] "r_ID[80,Intercept]"  "r_ID[81,Intercept]"  "r_ID[82,Intercept]" 
 [28] "r_ID[85,Intercept]"  "r_ID[86,Intercept]"  "r_ID[87,Intercept]" 
 [31] "r_ID[89,Intercept]"  "r_ID[91,Intercept]"  "r_ID[92,Intercept]" 
 [34] "r_ID[93,Intercept]"  "r_ID[94,Intercept]"  "r_ID[96,Intercept]" 
 [37] "r_ID[97,Intercept]"  "r_ID[98,Intercept]"  "r_ID[99,Intercept]" 
 [40] "r_ID[101,Intercept]" "r_ID[102,Intercept]" "r_ID[103,Intercept]"
 [43] "r_ID[104,Intercept]" "r_ID[105,Intercept]" "r_ID[106,Intercept]"
 [46] "r_ID[110,Intercept]" "r_ID[112,Intercept]" "r_ID[114,Intercept]"
 [49] "r_ID[115,Intercept]" "r_ID[116,Intercept]" "r_ID[120,Intercept]"
 [52] "r_ID[122,Intercept]" "r_ID[125,Intercept]" "r_ID[127,Intercept]"
 [55] "r_ID[129,Intercept]" "r_ID[135,Intercept]" "r_ID[136,Intercept]"
 [58] "r_ID[137,Intercept]" "r_ID[140,Intercept]" "r_ID[141,Intercept]"
 [61] "r_ID[142,Intercept]" "r_ID[143,Intercept]" "r_ID[144,Intercept]"
 [64] "r_ID[146,Intercept]" "r_ID[149,Intercept]" "r_ID[150,Intercept]"
 [67] "r_ID[152,Intercept]" "r_ID[153,Intercept]" "r_ID[155,Intercept]"
 [70] "r_ID[156,Intercept]" "r_ID[159,Intercept]" "r_ID[160,Intercept]"
 [73] "r_ID[162,Intercept]" "r_ID[163,Intercept]" "r_ID[165,Intercept]"
 [76] "r_ID[167,Intercept]" "r_ID[169,Intercept]" "r_ID[171,Intercept]"
 [79] "r_ID[174,Intercept]" "r_ID[182,Intercept]" "r_ID[187,Intercept]"
 [82] "r_ID[189,Intercept]" "r_ID[190,Intercept]" "r_ID[193,Intercept]"
 [85] "r_ID[194,Intercept]" "r_ID[201,Intercept]" "r_ID[204,Intercept]"
 [88] "r_ID[205,Intercept]" "r_ID[208,Intercept]" "r_ID[209,Intercept]"
 [91] "r_ID[211,Intercept]" "r_ID[214,Intercept]" "r_ID[219,Intercept]"
 [94] "r_ID[222,Intercept]" "r_ID[223,Intercept]" "r_ID[229,Intercept]"
 [97] "prior_Intercept"     "prior_b"             "prior_sigma"        
[100] "prior_sd_ID"         "lprior"              "lp__"               
[103] "accept_stat__"       "treedepth__"         "stepsize__"         
[106] "divergent__"         "n_leapfrog__"        "energy__"           </code></pre>
</div>
</div>
</section>
<section id="introducing-random-slopes" class="slide level2">
<h2>Introducing random slopes</h2>
<ul>
<li><p>MLMs “learn” from other units as we saw with random effects</p></li>
<li><p>MLMs can also “learn” about one parameter from another parameter</p></li>
<li><p>We do this through correlated features or parameters. We create this correlated features through introducing random slopes, which pools information across groups</p></li>
<li><p>This is another advantage of “keep it maximal.” Better estimates of intercepts rather than just fitting an intercept only model</p></li>
</ul>
</section>
<section id="random-slopes" class="slide level2">
<h2>Random slopes</h2>
<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}X_{ij} + \varepsilon_{ij}\]</span> Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} + \gamma_{01}G_{j} +   U_{0j}\]</span><br>
<span class="math display">\[{\beta}_{1j} = \gamma_{10} + \gamma_{11}G_{j} + U_{1j}\]</span></p>
<p><span class="math display">\[\begin{pmatrix} {U}_{0j} \\ {U}_{1j} \end{pmatrix}
\sim N \begin{pmatrix}
  0,      \tau_{00}^{2} &amp; \tau_{01}\\
  0,  \tau_{01} &amp; \tau_{10}^{2}
\end{pmatrix}\]</span></p>
</section>
<section id="correlated-features" class="slide level2">
<h2>correlated features</h2>
<ul>
<li><p>Modeling the joint population of intercepts and slopes, which means by modeling their covariance. We will use joint multivariate Gaussian distribution b/c it is max entropy distribution</p></li>
<li><p>Rather than a 1 dimension prior we will be putting on a two dimension prior.</p></li>
<li><p>Can scale into &gt; 2d depending on how many random effects you have</p></li>
</ul>
</section>
<section id="random-slopes-1" class="slide level2">
<h2>Random slopes</h2>
<p><span class="math display">\[y_{ij} \sim \text{Normal}(\mu_{ij}, \sigma)\]</span> <span class="math display">\[\mu_i = \beta_{0i} + \beta_{1i}X_{ij}\]</span> <span class="math display">\[(\beta_{0i}, \beta_{1i}) \sim \text{MVNormal}  ([\beta_0, \beta_1], \Sigma)\]</span></p>
<p><span class="math display">\[\Sigma =
\left(\begin{array}{cc}
\sigma_{\beta_0}&amp;0\\
0&amp;\sigma_{\beta_1}
\end{array}\right)R
\left(\begin{array}{cc}
\sigma_{\beta_0}&amp;0\\
0&amp;\sigma_{\beta_1}
\end{array}\right)\]</span> <span class="math display">\[\beta_0 \sim \text{Normal}(0, 1)\]</span></p>
<p><span class="math display">\[\beta_1 \sim \text{Normal}(0, 1)\]</span> <span class="math display">\[\sigma_{\beta_0} \sim \text{Exponential}(1)\]</span> <span class="math display">\[\sigma_{\beta_1} \sim \text{Exponential}(1)\]</span> <span class="math display">\[\sigma \sim \text{Exponential}(1)\]</span> <span class="math display">\[R \sim \text{LKJcorr(2)}\]</span></p>
</section>
<section class="slide level2">

<p>where Σ is the covariance matrix</p>
<p><span class="math display">\[\Sigma =
\left(\begin{array}{cc}
\sigma^2_{\beta_0}&amp;\sigma_{\beta_0}\sigma_{\beta_1}\rho\\
\sigma_{\beta_0}\sigma_{\beta_1}\rho&amp;\sigma^2_{\beta_1}
\end{array}\right)\]</span></p>
<p>and R is the correlation matrix R = <span class="math inline">\(\begin{bmatrix} 1 &amp; \rho \\ \rho &amp; 1 \end{bmatrix}\)</span>.</p>
<p>With more random effects, this matrix expands.</p>
</section>
<section id="lkj-1-parameter-correlation-prior" class="slide level2">
<h2>lkj 1 parameter correlation prior</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb57-2"><a href="#cb57-2"></a></span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="fu">expand.grid</span>(</span>
<span id="cb57-4"><a href="#cb57-4"></a>  <span class="at">eta =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb57-5"><a href="#cb57-5"></a>  <span class="at">K =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb57-6"><a href="#cb57-6"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb57-7"><a href="#cb57-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_rev</span>(<span class="fu">ordered</span>(eta)), <span class="at">dist =</span> <span class="st">"lkjcorr_marginal"</span>, <span class="at">arg1 =</span> K, <span class="at">arg2 =</span> eta)) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8"></a>  <span class="fu">stat_dist_slab</span>() <span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> <span class="fu">paste0</span>(K, <span class="st">"x"</span>, K)) <span class="sc">+</span></span>
<span id="cb57-10"><a href="#cb57-10"></a>  <span class="fu">labs</span>(</span>
<span id="cb57-11"><a href="#cb57-11"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(</span>
<span id="cb57-12"><a href="#cb57-12"></a>      <span class="st">"LKJ(eta) prior on different matrix sizes:</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb57-13"><a href="#cb57-13"></a>    ),</span>
<span id="cb57-14"><a href="#cb57-14"></a>    <span class="at">y =</span> <span class="st">"eta"</span>,</span>
<span id="cb57-15"><a href="#cb57-15"></a>    <span class="at">x =</span> <span class="st">"Marginal correlation"</span></span>
<span id="cb57-16"><a href="#cb57-16"></a>  ) <span class="sc">+</span></span>
<span id="cb57-17"><a href="#cb57-17"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-45-1.png" width="960" class="r-stretch"></section>
<section id="multivariate-distributions" class="slide level2">
<h2>Multivariate distributions</h2>
<p>r = 0. Knowing about 1 parameter doesn’t tell you anything about the other.</p>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-46-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>r = .5</p>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-47-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>r = .8</p>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-48-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">get_prior</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb58-2"><a href="#cb58-2"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> time <span class="sc">|</span> ID),</span>
<span id="cb58-3"><a href="#cb58-3"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  prior     class      coef group resp dpar nlpar lb ub
                 (flat)         b                                      
                 (flat)         b      time                            
                 lkj(1)       cor                                      
                 lkj(1)       cor              ID                      
 student_t(3, 0.2, 2.5) Intercept                                      
   student_t(3, 0, 2.5)        sd                                  0   
   student_t(3, 0, 2.5)        sd              ID                  0   
   student_t(3, 0, 2.5)        sd Intercept    ID                  0   
   student_t(3, 0, 2.5)        sd      time    ID                  0   
   student_t(3, 0, 2.5)     sigma                                  0   
       source
      default
 (vectorized)
      default
 (vectorized)
      default
      default
 (vectorized)
 (vectorized)
 (vectorized)
      default</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Information needed to learn about parameters can be ranked:</p>
<ol type="1">
<li>Means are easy</li>
<li>SDs are medium</li>
<li>Correlations are hard</li>
</ol>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>mlm<span class="fl">.4</span> <span class="ot">&lt;-</span> </span>
<span id="cb60-2"><a href="#cb60-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb60-3"><a href="#cb60-3"></a>      CON <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> time <span class="sc">|</span> ID),</span>
<span id="cb60-4"><a href="#cb60-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb60-5"><a href="#cb60-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> b),</span>
<span id="cb60-6"><a href="#cb60-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> Intercept, <span class="at">group =</span> ID), </span>
<span id="cb60-7"><a href="#cb60-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> time, <span class="at">group =</span> ID), </span>
<span id="cb60-8"><a href="#cb60-8"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb60-9"><a href="#cb60-9"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb60-10"><a href="#cb60-10"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb60-11"><a href="#cb60-11"></a>      <span class="at">file =</span> <span class="st">"mlm.4"</span>,</span>
<span id="cb60-12"><a href="#cb60-12"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb60-13"><a href="#cb60-13"></a>      <span class="at">data =</span> mlm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="fu">summary</span>(mlm<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: CON ~ 1 + time + (1 + time | ID) 
   Data: mlm (Number of observations: 225) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Multilevel Hyperparameters:
~ID (Number of levels: 91) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)           0.06      0.01     0.05     0.07 1.00     2754     4044
sd(time)                0.00      0.00     0.00     0.01 1.00      893      789
cor(Intercept,time)    -0.09      0.39    -0.76     0.73 1.00     6403     6816

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.19      0.01     0.18     0.21 1.00     2500     2552
time         -0.00      0.00    -0.01     0.00 1.00     7623     5535

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.05      0.00     0.04     0.05 1.00     2699     3099

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>p.mlm4 <span class="ot">&lt;-</span> <span class="fu">posterior_samples</span>(mlm<span class="fl">.4</span>)</span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb63-3"><a href="#cb63-3"></a></span>
<span id="cb63-4"><a href="#cb63-4"></a>r_2 <span class="ot">&lt;-</span> </span>
<span id="cb63-5"><a href="#cb63-5"></a>  <span class="fu">rlkjcorr</span>(<span class="dv">1000</span>, <span class="at">K =</span> <span class="dv">2</span>, <span class="at">eta =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-6"><a href="#cb63-6"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb63-7"><a href="#cb63-7"></a></span>
<span id="cb63-8"><a href="#cb63-8"></a>p.mlm4 <span class="sc">%&gt;%</span></span>
<span id="cb63-9"><a href="#cb63-9"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> r_2, <span class="fu">aes</span>(<span class="at">x =</span> V2),</span>
<span id="cb63-11"><a href="#cb63-11"></a>               <span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> cor_ID__Intercept__time),</span>
<span id="cb63-13"><a href="#cb63-13"></a>               <span class="at">color =</span> <span class="st">"transparent"</span>, <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">alpha =</span> <span class="dv">9</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb63-14"><a href="#cb63-14"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.15</span>, <span class="at">y =</span> <span class="fl">1.1</span>, </span>
<span id="cb63-15"><a href="#cb63-15"></a>           <span class="at">label =</span> <span class="st">"posterior"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">family =</span> <span class="st">"Courier"</span>) <span class="sc">+</span></span>
<span id="cb63-16"><a href="#cb63-16"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> .<span class="dv">2</span>, <span class="at">y =</span> <span class="fl">1.35</span>, </span>
<span id="cb63-17"><a href="#cb63-17"></a>           <span class="at">label =</span> <span class="st">"prior"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">family =</span> <span class="st">"Courier"</span>) <span class="sc">+</span></span>
<span id="cb63-18"><a href="#cb63-18"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb63-19"><a href="#cb63-19"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Correlation between intercepts</span><span class="sc">\n</span><span class="st">and slopes, prior and posterior"</span>,</span>
<span id="cb63-20"><a href="#cb63-20"></a>  <span class="at">x =</span> <span class="st">"correlation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-52-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>partially_pooled_params <span class="ot">&lt;-</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>  <span class="fu">coef</span>(mlm<span class="fl">.4</span>)<span class="sc">$</span>ID [ , <span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ID"</span>) </span>
<span id="cb64-4"><a href="#cb64-4"></a></span>
<span id="cb64-5"><a href="#cb64-5"></a></span>
<span id="cb64-6"><a href="#cb64-6"></a>un_pooled_params <span class="ot">&lt;-</span></span>
<span id="cb64-7"><a href="#cb64-7"></a>  mlm <span class="sc">%&gt;%</span></span>
<span id="cb64-8"><a href="#cb64-8"></a>  <span class="fu">group_by</span>(ID, time) <span class="sc">%&gt;%</span></span>
<span id="cb64-9"><a href="#cb64-9"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(CON)) <span class="sc">%&gt;%</span></span>
<span id="cb64-10"><a href="#cb64-10"></a>  <span class="fu">do</span>(<span class="fu">tidy</span>(<span class="fu">lm</span>(mean <span class="sc">~</span> time, <span class="at">data=</span>.))) <span class="sc">%&gt;%</span> </span>
<span id="cb64-11"><a href="#cb64-11"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb64-12"><a href="#cb64-12"></a>  <span class="fu">select</span>(ID, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb64-13"><a href="#cb64-13"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb64-14"><a href="#cb64-14"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-15"><a href="#cb64-15"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-16"><a href="#cb64-16"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID))</span>
<span id="cb64-17"><a href="#cb64-17"></a></span>
<span id="cb64-18"><a href="#cb64-18"></a>params <span class="ot">&lt;-</span></span>
<span id="cb64-19"><a href="#cb64-19"></a>  <span class="co"># `bind_rows()` will stack the second tibble below the first</span></span>
<span id="cb64-20"><a href="#cb64-20"></a>  <span class="fu">bind_rows</span>(partially_pooled_params, un_pooled_params) <span class="sc">%&gt;%</span></span>
<span id="cb64-21"><a href="#cb64-21"></a>  <span class="co"># index whether the estimates are pooled</span></span>
<span id="cb64-22"><a href="#cb64-22"></a>  <span class="fu">mutate</span>(<span class="at">pooled =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"partially"</span>, <span class="st">"not"</span>), <span class="at">each =</span> <span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">2</span>)) </span>
<span id="cb64-23"><a href="#cb64-23"></a></span>
<span id="cb64-24"><a href="#cb64-24"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb64-25"><a href="#cb64-25"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> params, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> Intercept)) <span class="sc">+</span></span>
<span id="cb64-26"><a href="#cb64-26"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb64-27"><a href="#cb64-27"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb64-28"><a href="#cb64-28"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb64-29"><a href="#cb64-29"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb64-30"><a href="#cb64-30"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb64-31"><a href="#cb64-31"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">6</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb64-32"><a href="#cb64-32"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">7</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb64-33"><a href="#cb64-33"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">8</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb64-34"><a href="#cb64-34"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> <span class="dv">9</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb64-35"><a href="#cb64-35"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="at">type =</span> <span class="st">"norm"</span>, <span class="at">level =</span> .<span class="dv">99</span>,  <span class="at">size =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"#E7CDC2"</span>) <span class="sc">+</span></span>
<span id="cb64-36"><a href="#cb64-36"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID, <span class="at">color =</span> pooled)) <span class="sc">+</span></span>
<span id="cb64-37"><a href="#cb64-37"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID), <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb64-38"><a href="#cb64-38"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Pooled?"</span>,</span>
<span id="cb64-39"><a href="#cb64-39"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#80A0C7"</span>, <span class="st">"#A65141"</span>)) <span class="sc">+</span></span>
<span id="cb64-40"><a href="#cb64-40"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(params<span class="sc">$</span>time),</span>
<span id="cb64-41"><a href="#cb64-41"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(params<span class="sc">$</span>Intercept))</span>
<span id="cb64-42"><a href="#cb64-42"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-53-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">get_variables</span>(mlm<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "b_Intercept"             "b_time"                 
  [3] "sd_ID__Intercept"        "sd_ID__time"            
  [5] "cor_ID__Intercept__time" "sigma"                  
  [7] "Intercept"               "r_ID[6,Intercept]"      
  [9] "r_ID[29,Intercept]"      "r_ID[34,Intercept]"     
 [11] "r_ID[36,Intercept]"      "r_ID[37,Intercept]"     
 [13] "r_ID[48,Intercept]"      "r_ID[53,Intercept]"     
 [15] "r_ID[54,Intercept]"      "r_ID[58,Intercept]"     
 [17] "r_ID[61,Intercept]"      "r_ID[66,Intercept]"     
 [19] "r_ID[67,Intercept]"      "r_ID[69,Intercept]"     
 [21] "r_ID[71,Intercept]"      "r_ID[74,Intercept]"     
 [23] "r_ID[75,Intercept]"      "r_ID[76,Intercept]"     
 [25] "r_ID[78,Intercept]"      "r_ID[79,Intercept]"     
 [27] "r_ID[80,Intercept]"      "r_ID[81,Intercept]"     
 [29] "r_ID[82,Intercept]"      "r_ID[85,Intercept]"     
 [31] "r_ID[86,Intercept]"      "r_ID[87,Intercept]"     
 [33] "r_ID[89,Intercept]"      "r_ID[91,Intercept]"     
 [35] "r_ID[92,Intercept]"      "r_ID[93,Intercept]"     
 [37] "r_ID[94,Intercept]"      "r_ID[96,Intercept]"     
 [39] "r_ID[97,Intercept]"      "r_ID[98,Intercept]"     
 [41] "r_ID[99,Intercept]"      "r_ID[101,Intercept]"    
 [43] "r_ID[102,Intercept]"     "r_ID[103,Intercept]"    
 [45] "r_ID[104,Intercept]"     "r_ID[105,Intercept]"    
 [47] "r_ID[106,Intercept]"     "r_ID[110,Intercept]"    
 [49] "r_ID[112,Intercept]"     "r_ID[114,Intercept]"    
 [51] "r_ID[115,Intercept]"     "r_ID[116,Intercept]"    
 [53] "r_ID[120,Intercept]"     "r_ID[122,Intercept]"    
 [55] "r_ID[125,Intercept]"     "r_ID[127,Intercept]"    
 [57] "r_ID[129,Intercept]"     "r_ID[135,Intercept]"    
 [59] "r_ID[136,Intercept]"     "r_ID[137,Intercept]"    
 [61] "r_ID[140,Intercept]"     "r_ID[141,Intercept]"    
 [63] "r_ID[142,Intercept]"     "r_ID[143,Intercept]"    
 [65] "r_ID[144,Intercept]"     "r_ID[146,Intercept]"    
 [67] "r_ID[149,Intercept]"     "r_ID[150,Intercept]"    
 [69] "r_ID[152,Intercept]"     "r_ID[153,Intercept]"    
 [71] "r_ID[155,Intercept]"     "r_ID[156,Intercept]"    
 [73] "r_ID[159,Intercept]"     "r_ID[160,Intercept]"    
 [75] "r_ID[162,Intercept]"     "r_ID[163,Intercept]"    
 [77] "r_ID[165,Intercept]"     "r_ID[167,Intercept]"    
 [79] "r_ID[169,Intercept]"     "r_ID[171,Intercept]"    
 [81] "r_ID[174,Intercept]"     "r_ID[182,Intercept]"    
 [83] "r_ID[187,Intercept]"     "r_ID[189,Intercept]"    
 [85] "r_ID[190,Intercept]"     "r_ID[193,Intercept]"    
 [87] "r_ID[194,Intercept]"     "r_ID[201,Intercept]"    
 [89] "r_ID[204,Intercept]"     "r_ID[205,Intercept]"    
 [91] "r_ID[208,Intercept]"     "r_ID[209,Intercept]"    
 [93] "r_ID[211,Intercept]"     "r_ID[214,Intercept]"    
 [95] "r_ID[219,Intercept]"     "r_ID[222,Intercept]"    
 [97] "r_ID[223,Intercept]"     "r_ID[229,Intercept]"    
 [99] "r_ID[6,time]"            "r_ID[29,time]"          
[101] "r_ID[34,time]"           "r_ID[36,time]"          
[103] "r_ID[37,time]"           "r_ID[48,time]"          
[105] "r_ID[53,time]"           "r_ID[54,time]"          
[107] "r_ID[58,time]"           "r_ID[61,time]"          
[109] "r_ID[66,time]"           "r_ID[67,time]"          
[111] "r_ID[69,time]"           "r_ID[71,time]"          
[113] "r_ID[74,time]"           "r_ID[75,time]"          
[115] "r_ID[76,time]"           "r_ID[78,time]"          
[117] "r_ID[79,time]"           "r_ID[80,time]"          
[119] "r_ID[81,time]"           "r_ID[82,time]"          
[121] "r_ID[85,time]"           "r_ID[86,time]"          
[123] "r_ID[87,time]"           "r_ID[89,time]"          
[125] "r_ID[91,time]"           "r_ID[92,time]"          
[127] "r_ID[93,time]"           "r_ID[94,time]"          
[129] "r_ID[96,time]"           "r_ID[97,time]"          
[131] "r_ID[98,time]"           "r_ID[99,time]"          
[133] "r_ID[101,time]"          "r_ID[102,time]"         
[135] "r_ID[103,time]"          "r_ID[104,time]"         
[137] "r_ID[105,time]"          "r_ID[106,time]"         
[139] "r_ID[110,time]"          "r_ID[112,time]"         
[141] "r_ID[114,time]"          "r_ID[115,time]"         
[143] "r_ID[116,time]"          "r_ID[120,time]"         
[145] "r_ID[122,time]"          "r_ID[125,time]"         
[147] "r_ID[127,time]"          "r_ID[129,time]"         
[149] "r_ID[135,time]"          "r_ID[136,time]"         
[151] "r_ID[137,time]"          "r_ID[140,time]"         
[153] "r_ID[141,time]"          "r_ID[142,time]"         
[155] "r_ID[143,time]"          "r_ID[144,time]"         
[157] "r_ID[146,time]"          "r_ID[149,time]"         
[159] "r_ID[150,time]"          "r_ID[152,time]"         
[161] "r_ID[153,time]"          "r_ID[155,time]"         
[163] "r_ID[156,time]"          "r_ID[159,time]"         
[165] "r_ID[160,time]"          "r_ID[162,time]"         
[167] "r_ID[163,time]"          "r_ID[165,time]"         
[169] "r_ID[167,time]"          "r_ID[169,time]"         
[171] "r_ID[171,time]"          "r_ID[174,time]"         
[173] "r_ID[182,time]"          "r_ID[187,time]"         
[175] "r_ID[189,time]"          "r_ID[190,time]"         
[177] "r_ID[193,time]"          "r_ID[194,time]"         
[179] "r_ID[201,time]"          "r_ID[204,time]"         
[181] "r_ID[205,time]"          "r_ID[208,time]"         
[183] "r_ID[209,time]"          "r_ID[211,time]"         
[185] "r_ID[214,time]"          "r_ID[219,time]"         
[187] "r_ID[222,time]"          "r_ID[223,time]"         
[189] "r_ID[229,time]"          "lprior"                 
[191] "lp__"                    "accept_stat__"          
[193] "treedepth__"             "stepsize__"             
[195] "divergent__"             "n_leapfrog__"           
[197] "energy__"               </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>mlm<span class="fl">.4</span> <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>  <span class="fu">spread_draws</span>(r_ID[ID,term]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,184,000 × 6
# Groups:   ID, term [182]
      ID term         r_ID .chain .iteration .draw
   &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
 1     6 Intercept  0.0380      1          1     1
 2     6 Intercept  0.0503      1          2     2
 3     6 Intercept  0.0210      1          3     3
 4     6 Intercept  0.0227      1          4     4
 5     6 Intercept -0.0346      1          5     5
 6     6 Intercept -0.0238      1          6     6
 7     6 Intercept  0.0162      1          7     7
 8     6 Intercept  0.0454      1          8     8
 9     6 Intercept  0.0639      1          9     9
10     6 Intercept  0.0639      1         10    10
# ℹ 2,183,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>mlm<span class="fl">.4</span> <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>  <span class="fu">spread_draws</span>(b_time, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"time"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-4"><a href="#cb69-4"></a>  <span class="fu">mutate</span>(<span class="at">person_t =</span> b_time <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb69-5"><a href="#cb69-5"></a> <span class="fu">median_qi</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    ID term      b_time b_time.lower b_time.upper          r_ID   r_ID.lower
1    6 time -0.00288307 -0.007413186  0.001494496  2.551040e-05 -0.009898765
2   29 time -0.00288307 -0.007413186  0.001494496 -3.723525e-04 -0.014526957
3   34 time -0.00288307 -0.007413186  0.001494496 -6.486720e-04 -0.014252208
4   36 time -0.00288307 -0.007413186  0.001494496  1.607680e-04 -0.008294971
5   37 time -0.00288307 -0.007413186  0.001494496 -2.435765e-04 -0.012196813
6   48 time -0.00288307 -0.007413186  0.001494496 -3.672625e-05 -0.010818820
7   53 time -0.00288307 -0.007413186  0.001494496 -3.022895e-04 -0.013401510
8   54 time -0.00288307 -0.007413186  0.001494496  2.134170e-04 -0.008616770
9   58 time -0.00288307 -0.007413186  0.001494496  6.172875e-04 -0.006801142
10  61 time -0.00288307 -0.007413186  0.001494496 -9.314035e-05 -0.011067097
11  66 time -0.00288307 -0.007413186  0.001494496  1.030245e-03 -0.004882273
12  67 time -0.00288307 -0.007413186  0.001494496 -1.714320e-05 -0.010062257
13  69 time -0.00288307 -0.007413186  0.001494496 -1.559000e-04 -0.012293787
14  71 time -0.00288307 -0.007413186  0.001494496 -2.929185e-04 -0.015442737
15  74 time -0.00288307 -0.007413186  0.001494496  1.668400e-04 -0.007733413
16  75 time -0.00288307 -0.007413186  0.001494496  5.138765e-04 -0.007592220
17  76 time -0.00288307 -0.007413186  0.001494496  3.940060e-06 -0.012619062
18  78 time -0.00288307 -0.007413186  0.001494496  6.207030e-04 -0.006174140
19  79 time -0.00288307 -0.007413186  0.001494496  1.926895e-04 -0.008767686
20  80 time -0.00288307 -0.007413186  0.001494496 -1.090110e-04 -0.010567375
21  81 time -0.00288307 -0.007413186  0.001494496  6.703450e-04 -0.006397769
22  82 time -0.00288307 -0.007413186  0.001494496  8.243415e-04 -0.007390980
23  85 time -0.00288307 -0.007413186  0.001494496  7.053525e-05 -0.009567806
24  86 time -0.00288307 -0.007413186  0.001494496  4.906425e-05 -0.011019077
25  87 time -0.00288307 -0.007413186  0.001494496 -4.679595e-04 -0.016825205
26  89 time -0.00288307 -0.007413186  0.001494496  1.397715e-04 -0.009567952
27  91 time -0.00288307 -0.007413186  0.001494496 -2.151660e-05 -0.012549290
28  92 time -0.00288307 -0.007413186  0.001494496 -1.661000e-05 -0.011717628
29  93 time -0.00288307 -0.007413186  0.001494496 -3.183175e-04 -0.014993192
30  94 time -0.00288307 -0.007413186  0.001494496 -8.775670e-05 -0.012737855
31  96 time -0.00288307 -0.007413186  0.001494496  4.098125e-05 -0.011154307
32  97 time -0.00288307 -0.007413186  0.001494496  1.799355e-04 -0.008795879
33  98 time -0.00288307 -0.007413186  0.001494496 -7.119005e-04 -0.017275902
34  99 time -0.00288307 -0.007413186  0.001494496  4.344270e-05 -0.009981410
35 101 time -0.00288307 -0.007413186  0.001494496  8.014890e-05 -0.010051545
36 102 time -0.00288307 -0.007413186  0.001494496 -4.162105e-05 -0.011429627
37 103 time -0.00288307 -0.007413186  0.001494496 -6.409885e-07 -0.011340305
38 104 time -0.00288307 -0.007413186  0.001494496 -2.111280e-05 -0.011732700
39 105 time -0.00288307 -0.007413186  0.001494496 -9.725975e-05 -0.012742075
40 106 time -0.00288307 -0.007413186  0.001494496 -4.303440e-05 -0.012093682
41 110 time -0.00288307 -0.007413186  0.001494496 -2.795805e-04 -0.013103612
42 112 time -0.00288307 -0.007413186  0.001494496  2.622560e-04 -0.008497947
43 114 time -0.00288307 -0.007413186  0.001494496  2.194390e-04 -0.008730339
44 115 time -0.00288307 -0.007413186  0.001494496  6.103735e-04 -0.006575728
45 116 time -0.00288307 -0.007413186  0.001494496  4.710030e-04 -0.006966198
46 120 time -0.00288307 -0.007413186  0.001494496 -2.629245e-04 -0.015955087
47 122 time -0.00288307 -0.007413186  0.001494496  1.187420e-04 -0.009109261
48 125 time -0.00288307 -0.007413186  0.001494496  7.319600e-05 -0.009542659
49 127 time -0.00288307 -0.007413186  0.001494496 -1.740900e-04 -0.013631932
50 129 time -0.00288307 -0.007413186  0.001494496  5.847555e-05 -0.011316770
51 135 time -0.00288307 -0.007413186  0.001494496  4.678005e-04 -0.008468870
52 136 time -0.00288307 -0.007413186  0.001494496 -3.203075e-04 -0.015242960
53 137 time -0.00288307 -0.007413186  0.001494496 -1.689285e-04 -0.014663322
54 140 time -0.00288307 -0.007413186  0.001494496  3.639185e-05 -0.010188612
55 141 time -0.00288307 -0.007413186  0.001494496  3.664950e-04 -0.007409238
56 142 time -0.00288307 -0.007413186  0.001494496  3.208975e-05 -0.010094702
57 143 time -0.00288307 -0.007413186  0.001494496  8.787170e-06 -0.012446535
58 144 time -0.00288307 -0.007413186  0.001494496  1.919485e-04 -0.008541148
59 146 time -0.00288307 -0.007413186  0.001494496  1.563540e-04 -0.008963647
60 149 time -0.00288307 -0.007413186  0.001494496 -1.889655e-04 -0.013056120
61 150 time -0.00288307 -0.007413186  0.001494496  1.212510e-04 -0.009249908
62 152 time -0.00288307 -0.007413186  0.001494496 -1.346400e-04 -0.012415887
63 153 time -0.00288307 -0.007413186  0.001494496 -4.582690e-04 -0.015623722
64 155 time -0.00288307 -0.007413186  0.001494496  5.623335e-05 -0.010520440
65 156 time -0.00288307 -0.007413186  0.001494496 -3.325305e-04 -0.013505275
66 159 time -0.00288307 -0.007413186  0.001494496  7.451425e-05 -0.010602800
67 160 time -0.00288307 -0.007413186  0.001494496  5.070065e-04 -0.007006468
68 162 time -0.00288307 -0.007413186  0.001494496 -8.512155e-04 -0.020756738
69 163 time -0.00288307 -0.007413186  0.001494496 -2.138930e-05 -0.010441687
70 165 time -0.00288307 -0.007413186  0.001494496 -2.091510e-04 -0.013867303
71 167 time -0.00288307 -0.007413186  0.001494496 -1.983530e-04 -0.012990317
72 169 time -0.00288307 -0.007413186  0.001494496 -1.715490e-05 -0.011007310
73 171 time -0.00288307 -0.007413186  0.001494496 -1.964685e-04 -0.013238697
74 174 time -0.00288307 -0.007413186  0.001494496 -2.151215e-04 -0.013905212
75 182 time -0.00288307 -0.007413186  0.001494496  9.919170e-05 -0.009169816
76 187 time -0.00288307 -0.007413186  0.001494496 -3.111960e-05 -0.011337350
77 189 time -0.00288307 -0.007413186  0.001494496  5.785055e-04 -0.006670557
78 190 time -0.00288307 -0.007413186  0.001494496 -2.391385e-04 -0.012891540
79 193 time -0.00288307 -0.007413186  0.001494496 -2.550135e-04 -0.013739920
80 194 time -0.00288307 -0.007413186  0.001494496 -1.478380e-04 -0.012057372
81 201 time -0.00288307 -0.007413186  0.001494496  1.339670e-04 -0.009697117
82 204 time -0.00288307 -0.007413186  0.001494496 -4.765765e-04 -0.016970300
83 205 time -0.00288307 -0.007413186  0.001494496 -1.264150e-04 -0.012460447
84 208 time -0.00288307 -0.007413186  0.001494496  5.453745e-04 -0.006649585
85 209 time -0.00288307 -0.007413186  0.001494496  4.070170e-04 -0.007619577
86 211 time -0.00288307 -0.007413186  0.001494496 -3.804820e-04 -0.014498460
87 214 time -0.00288307 -0.007413186  0.001494496 -5.774715e-05 -0.012620900
88 219 time -0.00288307 -0.007413186  0.001494496  2.806980e-04 -0.008113985
89 222 time -0.00288307 -0.007413186  0.001494496  4.076645e-04 -0.007012781
90 223 time -0.00288307 -0.007413186  0.001494496 -7.209980e-04 -0.017925555
91 229 time -0.00288307 -0.007413186  0.001494496 -5.890570e-04 -0.017644988
    r_ID.upper     person_t person_t.lower person_t.upper .width .point
1  0.010446923 -0.002707828   -0.013480687    0.007464279   0.95 median
2  0.008546770 -0.003586062   -0.018152760    0.006103560   0.95 median
3  0.006773089 -0.003938746   -0.017709587    0.004938582   0.95 median
4  0.012809127 -0.002457118   -0.011942178    0.009949032   0.95 median
5  0.008306398 -0.003370095   -0.015823664    0.005561243   0.95 median
6  0.009273489 -0.002949671   -0.014137550    0.006699696   0.95 median
7  0.007562482 -0.003477636   -0.016586821    0.005057014   0.95 median
8  0.011494155 -0.002376402   -0.011780523    0.008641578   0.95 median
9  0.015843567 -0.001728316   -0.010459427    0.012620773   0.95 median
10 0.010560227 -0.003089813   -0.014699399    0.008035918   0.95 median
11 0.015752125 -0.001246260   -0.008882746    0.012508067   0.95 median
12 0.009539482 -0.002939634   -0.013201321    0.006423880   0.95 median
13 0.009182916 -0.003206244   -0.015898150    0.006547519   0.95 median
14 0.010426675 -0.003370612   -0.019245688    0.007931890   0.95 median
15 0.010488235 -0.002445496   -0.011457868    0.007554454   0.95 median
16 0.016243415 -0.001899773   -0.010909494    0.013177845   0.95 median
17 0.012027102 -0.002834934   -0.017126420    0.009310978   0.95 median
18 0.013127887 -0.001808467   -0.009692989    0.010089979   0.95 median
19 0.015059397 -0.002279451   -0.012691625    0.012219621   0.95 median
20 0.009387660 -0.003157498   -0.014120494    0.006925745   0.95 median
21 0.012767742 -0.001728692   -0.009915610    0.009736540   0.95 median
22 0.015418865 -0.001600659   -0.010736900    0.011891746   0.95 median
23 0.012932555 -0.002627180   -0.013488420    0.010260371   0.95 median
24 0.013656800 -0.002625347   -0.014711044    0.010594190   0.95 median
25 0.008322527 -0.003675596   -0.020261777    0.006313691   0.95 median
26 0.014258512 -0.002461018   -0.013486322    0.011735107   0.95 median
27 0.010045882 -0.002898099   -0.016348093    0.007577559   0.95 median
28 0.009914474 -0.002926535   -0.015401458    0.007186688   0.95 median
29 0.007853980 -0.003501564   -0.018458315    0.005395397   0.95 median
30 0.010115032 -0.003040649   -0.016795570    0.007745804   0.95 median
31 0.012035267 -0.002688159   -0.014820960    0.009213668   0.95 median
32 0.012802997 -0.002380050   -0.012109556    0.009741724   0.95 median
33 0.006171946 -0.004080655   -0.021077208    0.004185570   0.95 median
34 0.011396712 -0.002647324   -0.013799542    0.008929403   0.95 median
35 0.012210943 -0.002563547   -0.013381798    0.009635644   0.95 median
36 0.009966423 -0.002941425   -0.015242920    0.007553596   0.95 median
37 0.011455527 -0.002827939   -0.015009415    0.009154179   0.95 median
38 0.011929500 -0.002823155   -0.015418608    0.009227995   0.95 median
39 0.009913928 -0.003068571   -0.016283800    0.007435431   0.95 median
40 0.010220772 -0.002956492   -0.015731700    0.007532218   0.95 median
41 0.007897809 -0.003470900   -0.017016931    0.005571478   0.95 median
42 0.014808062 -0.002178144   -0.012348582    0.012102731   0.95 median
43 0.013062405 -0.002307515   -0.012749692    0.010324107   0.95 median
44 0.015998758 -0.001691622   -0.010530975    0.013172875   0.95 median
45 0.015670562 -0.001875650   -0.011171954    0.012962650   0.95 median
46 0.011012717 -0.003339104   -0.019102187    0.008210307   0.95 median
47 0.011990287 -0.002516781   -0.013116360    0.009313206   0.95 median
48 0.012159202 -0.002592410   -0.013245560    0.009479800   0.95 median
49 0.008337385 -0.003270366   -0.017691736    0.005861485   0.95 median
50 0.013257660 -0.002626900   -0.015227261    0.010634661   0.95 median
51 0.014242113 -0.002045665   -0.012002671    0.011454025   0.95 median
52 0.009223198 -0.003484870   -0.018762708    0.006446311   0.95 median
53 0.009562660 -0.003298736   -0.018464729    0.006995994   0.95 median
54 0.012597930 -0.002647334   -0.014209438    0.009905122   0.95 median
55 0.014930270 -0.002034260   -0.011213477    0.012512040   0.95 median
56 0.011793862 -0.002745724   -0.013919637    0.008916183   0.95 median
57 0.012310900 -0.002855410   -0.015898036    0.009362862   0.95 median
58 0.012981207 -0.002388338   -0.012375717    0.010478941   0.95 median
59 0.012627800 -0.002438992   -0.012399091    0.009739825   0.95 median
60 0.009103113 -0.003275083   -0.016582142    0.006357370   0.95 median
61 0.011268322 -0.002554661   -0.013047201    0.008402770   0.95 median
62 0.009816269 -0.003238350   -0.016126785    0.007423978   0.95 median
63 0.007270004 -0.003690015   -0.018864665    0.005040600   0.95 median
64 0.012168102 -0.002624346   -0.014610200    0.009646551   0.95 median
65 0.008579389 -0.003482611   -0.017283721    0.005958657   0.95 median
66 0.013787572 -0.002565081   -0.014763226    0.010811780   0.95 median
67 0.016636112 -0.001853584   -0.010884035    0.013861075   0.95 median
68 0.009696792 -0.004066963   -0.024322549    0.007167129   0.95 median
69 0.010880882 -0.002844813   -0.014294741    0.008170205   0.95 median
70 0.008512808 -0.003338302   -0.017568687    0.005967029   0.95 median
71 0.009427965 -0.003223515   -0.016675850    0.006844643   0.95 median
72 0.010650827 -0.002945005   -0.014520457    0.007596671   0.95 median
73 0.008676629 -0.003305850   -0.016954837    0.006225422   0.95 median
74 0.008208154 -0.003371625   -0.017566097    0.005686303   0.95 median
75 0.011900502 -0.002514155   -0.012995288    0.009384178   0.95 median
76 0.012412320 -0.002875418   -0.015203989    0.010078470   0.95 median
77 0.016028542 -0.001764730   -0.010527348    0.012830423   0.95 median
78 0.008753038 -0.003404010   -0.016902356    0.006502136   0.95 median
79 0.008043818 -0.003456384   -0.017458154    0.005939817   0.95 median
80 0.009554144 -0.003192541   -0.015950931    0.007168108   0.95 median
81 0.012821220 -0.002493485   -0.013155586    0.010293783   0.95 median
82 0.008089703 -0.003700577   -0.020700119    0.005756442   0.95 median
83 0.009107135 -0.003133638   -0.016450976    0.006802311   0.95 median
84 0.015451652 -0.001816546   -0.010378585    0.012589200   0.95 median
85 0.015713755 -0.001994748   -0.011550003    0.012783276   0.95 median
86 0.007850229 -0.003605399   -0.018419003    0.005491238   0.95 median
87 0.009872309 -0.002992045   -0.016330875    0.007297714   0.95 median
88 0.013616585 -0.002201948   -0.011791802    0.010732382   0.95 median
89 0.014730412 -0.002014628   -0.010917830    0.011954867   0.95 median
90 0.005887812 -0.004110984   -0.021986381    0.004008218   0.95 median
91 0.006748036 -0.003979961   -0.021684510    0.004904578   0.95 median
   .interval
1         qi
2         qi
3         qi
4         qi
5         qi
6         qi
7         qi
8         qi
9         qi
10        qi
11        qi
12        qi
13        qi
14        qi
15        qi
16        qi
17        qi
18        qi
19        qi
20        qi
21        qi
22        qi
23        qi
24        qi
25        qi
26        qi
27        qi
28        qi
29        qi
30        qi
31        qi
32        qi
33        qi
34        qi
35        qi
36        qi
37        qi
38        qi
39        qi
40        qi
41        qi
42        qi
43        qi
44        qi
45        qi
46        qi
47        qi
48        qi
49        qi
50        qi
51        qi
52        qi
53        qi
54        qi
55        qi
56        qi
57        qi
58        qi
59        qi
60        qi
61        qi
62        qi
63        qi
64        qi
65        qi
66        qi
67        qi
68        qi
69        qi
70        qi
71        qi
72        qi
73        qi
74        qi
75        qi
76        qi
77        qi
78        qi
79        qi
80        qi
81        qi
82        qi
83        qi
84        qi
85        qi
86        qi
87        qi
88        qi
89        qi
90        qi
91        qi</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>mlm<span class="fl">.4</span> <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>  <span class="fu">spread_draws</span>(b_time, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="#cb71-3"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"time"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-4"><a href="#cb71-4"></a>  <span class="fu">median_qi</span>(<span class="at">person_t =</span> b_time <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb71-5"><a href="#cb71-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">y =</span> <span class="fu">reorder</span>(ID, person_t), <span class="at">x =</span> person_t, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb71-6"><a href="#cb71-6"></a>  <span class="fu">geom_pointinterval</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"est"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-57-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>mlm<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.3</span>, <span class="st">"loo"</span>)</span>
<span id="cb72-2"><a href="#cb72-2"></a>mlm<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mlm<span class="fl">.4</span>, <span class="st">"loo"</span>)</span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="fu">loo_compare</span>(mlm<span class="fl">.3</span>, mlm<span class="fl">.4</span>, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      elpd_diff se_diff
mlm.3  0.0       0.0   
mlm.4 -0.5       0.5   </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb74-2"><a href="#cb74-2"></a>esm <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/bayes2022/main/static/Lectures/esm_w1_RENAMED.csv"</span>)</span>
<span id="cb74-3"><a href="#cb74-3"></a>esm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,540 × 89
    ...1 esm.IDnum.w1 esm.PRO01.w1 esm.PRO02.w1 esm.PRO03.w1
   &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
 1     1        10549           17            1            1
 2     2        10547           57            1            1
 3     3        10547           57            1            1
 4     4        10539           51            1            1
 5     5        10547           57            1            1
 6     6        10549           17            1            1
 7     7        10539           51            1            1
 8     8        10549           17            1            1
 9     9        10547           57            1            1
10    10        10526           36            1            1
# ℹ 11,530 more rows
# ℹ 84 more variables: esm.startDateTime.w1 &lt;chr&gt;, esm.PRO04.w1 &lt;dbl&gt;,
#   esm.PRO05.w1 &lt;dbl&gt;, esm.PRO06.w1 &lt;dbl&gt;, esm.PRO07.w1 &lt;dbl&gt;,
#   esm.endDateTime.w1 &lt;chr&gt;, esm.OR.w1 &lt;chr&gt;, esm.NQ11.w1 &lt;dbl&gt;,
#   esm.NQ12.w1 &lt;dbl&gt;, esm.EXT.w1 &lt;dbl&gt;, esm.AGR.w1 &lt;dbl&gt;, esm.CON.w1 &lt;dbl&gt;,
#   esm.NEU.w1 &lt;dbl&gt;, `esm.NQ11+1.w1` &lt;dbl&gt;, `esm.NQ12+1.w1` &lt;dbl&gt;,
#   `esm.EXT+1.w1` &lt;dbl&gt;, `esm.AGR+1.w1` &lt;dbl&gt;, `esm.CON+1.w1` &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>esm<span class="sc">$</span>PA <span class="ot">&lt;-</span> esm<span class="sc">$</span>esm.NQ11.w1</span>
<span id="cb76-2"><a href="#cb76-2"></a>esm<span class="sc">$</span>W.other <span class="ot">&lt;-</span> esm<span class="sc">$</span>esm.ST04.w1</span>
<span id="cb76-3"><a href="#cb76-3"></a>esm<span class="sc">$</span>ID <span class="ot">&lt;-</span> esm<span class="sc">$</span>esm.IDnum.w1</span>
<span id="cb76-4"><a href="#cb76-4"></a></span>
<span id="cb76-5"><a href="#cb76-5"></a><span class="fu">library</span>(lme4)</span>
<span id="cb76-6"><a href="#cb76-6"></a>test <span class="ot">&lt;-</span> <span class="fu">lmer</span>(PA <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> W.other  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> W.other  <span class="sc">|</span> ID), <span class="at">data =</span> esm )</span>
<span id="cb76-7"><a href="#cb76-7"></a><span class="fu">summary</span>(test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: PA ~ 1 + W.other + (1 + W.other | ID)
   Data: esm

REML criterion at convergence: 24523.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.5746 -0.6263  0.0180  0.6978  2.8135 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 ID       (Intercept) 0.25954  0.5094        
          W.other     0.03266  0.1807   -0.56
 Residual             0.72255  0.8500        
Number of obs: 9461, groups:  ID, 364

Fixed effects:
            Estimate Std. Error t value
(Intercept)  3.15230    0.03538   89.09
W.other      0.31802    0.02612   12.18

Correlation of Fixed Effects:
        (Intr)
W.other -0.686</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>mlm<span class="fl">.5</span> <span class="ot">&lt;-</span> </span>
<span id="cb78-2"><a href="#cb78-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb78-3"><a href="#cb78-3"></a>      PA <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> W.other  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> W.other  <span class="sc">|</span> ID),</span>
<span id="cb78-4"><a href="#cb78-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb78-5"><a href="#cb78-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb78-6"><a href="#cb78-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> Intercept, <span class="at">group =</span> ID), </span>
<span id="cb78-7"><a href="#cb78-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> W.other, <span class="at">group =</span> ID), </span>
<span id="cb78-8"><a href="#cb78-8"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb78-9"><a href="#cb78-9"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">10</span>), <span class="at">class =</span> cor)),</span>
<span id="cb78-10"><a href="#cb78-10"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb78-11"><a href="#cb78-11"></a>      <span class="at">sample_prior =</span> <span class="cn">TRUE</span>,</span>
<span id="cb78-12"><a href="#cb78-12"></a>      <span class="at">file =</span> <span class="st">"mlm.5"</span>,</span>
<span id="cb78-13"><a href="#cb78-13"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb78-14"><a href="#cb78-14"></a>      <span class="at">data =</span> esm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>747 parameters in our posterior</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="fu">get_variables</span>(mlm<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "b_Intercept"                "b_W.other"                 
  [3] "sd_ID__Intercept"           "sd_ID__W.other"            
  [5] "cor_ID__Intercept__W.other" "sigma"                     
  [7] "Intercept"                  "r_ID[81,Intercept]"        
  [9] "r_ID[86,Intercept]"         "r_ID[87,Intercept]"        
 [11] "r_ID[88,Intercept]"         "r_ID[89,Intercept]"        
 [13] "r_ID[90,Intercept]"         "r_ID[91,Intercept]"        
 [15] "r_ID[92,Intercept]"         "r_ID[93,Intercept]"        
 [17] "r_ID[94,Intercept]"         "r_ID[95,Intercept]"        
 [19] "r_ID[97,Intercept]"         "r_ID[98,Intercept]"        
 [21] "r_ID[100,Intercept]"        "r_ID[101,Intercept]"       
 [23] "r_ID[102,Intercept]"        "r_ID[104,Intercept]"       
 [25] "r_ID[10105,Intercept]"      "r_ID[10106,Intercept]"     
 [27] "r_ID[10107,Intercept]"      "r_ID[10108,Intercept]"     
 [29] "r_ID[10109,Intercept]"      "r_ID[10110,Intercept]"     
 [31] "r_ID[10111,Intercept]"      "r_ID[10112,Intercept]"     
 [33] "r_ID[10113,Intercept]"      "r_ID[10114,Intercept]"     
 [35] "r_ID[10116,Intercept]"      "r_ID[10117,Intercept]"     
 [37] "r_ID[10118,Intercept]"      "r_ID[10121,Intercept]"     
 [39] "r_ID[10122,Intercept]"      "r_ID[10123,Intercept]"     
 [41] "r_ID[10124,Intercept]"      "r_ID[10125,Intercept]"     
 [43] "r_ID[10126,Intercept]"      "r_ID[10127,Intercept]"     
 [45] "r_ID[10128,Intercept]"      "r_ID[10129,Intercept]"     
 [47] "r_ID[10130,Intercept]"      "r_ID[10131,Intercept]"     
 [49] "r_ID[10132,Intercept]"      "r_ID[10133,Intercept]"     
 [51] "r_ID[10134,Intercept]"      "r_ID[10136,Intercept]"     
 [53] "r_ID[10137,Intercept]"      "r_ID[10138,Intercept]"     
 [55] "r_ID[10139,Intercept]"      "r_ID[10141,Intercept]"     
 [57] "r_ID[10143,Intercept]"      "r_ID[10144,Intercept]"     
 [59] "r_ID[10145,Intercept]"      "r_ID[10147,Intercept]"     
 [61] "r_ID[10148,Intercept]"      "r_ID[10149,Intercept]"     
 [63] "r_ID[10150,Intercept]"      "r_ID[10151,Intercept]"     
 [65] "r_ID[10153,Intercept]"      "r_ID[10154,Intercept]"     
 [67] "r_ID[10155,Intercept]"      "r_ID[10157,Intercept]"     
 [69] "r_ID[10158,Intercept]"      "r_ID[10159,Intercept]"     
 [71] "r_ID[10160,Intercept]"      "r_ID[10161,Intercept]"     
 [73] "r_ID[10162,Intercept]"      "r_ID[10164,Intercept]"     
 [75] "r_ID[10166,Intercept]"      "r_ID[10167,Intercept]"     
 [77] "r_ID[10171,Intercept]"      "r_ID[10172,Intercept]"     
 [79] "r_ID[10173,Intercept]"      "r_ID[10174,Intercept]"     
 [81] "r_ID[10175,Intercept]"      "r_ID[10176,Intercept]"     
 [83] "r_ID[10177,Intercept]"      "r_ID[10178,Intercept]"     
 [85] "r_ID[10180,Intercept]"      "r_ID[10181,Intercept]"     
 [87] "r_ID[10184,Intercept]"      "r_ID[10185,Intercept]"     
 [89] "r_ID[10186,Intercept]"      "r_ID[10187,Intercept]"     
 [91] "r_ID[10188,Intercept]"      "r_ID[10190,Intercept]"     
 [93] "r_ID[10192,Intercept]"      "r_ID[10193,Intercept]"     
 [95] "r_ID[10194,Intercept]"      "r_ID[10195,Intercept]"     
 [97] "r_ID[10196,Intercept]"      "r_ID[10197,Intercept]"     
 [99] "r_ID[10198,Intercept]"      "r_ID[10199,Intercept]"     
[101] "r_ID[10200,Intercept]"      "r_ID[10201,Intercept]"     
[103] "r_ID[10202,Intercept]"      "r_ID[10203,Intercept]"     
[105] "r_ID[10204,Intercept]"      "r_ID[10205,Intercept]"     
[107] "r_ID[10206,Intercept]"      "r_ID[10207,Intercept]"     
[109] "r_ID[10208,Intercept]"      "r_ID[10210,Intercept]"     
[111] "r_ID[10211,Intercept]"      "r_ID[10212,Intercept]"     
[113] "r_ID[10213,Intercept]"      "r_ID[10214,Intercept]"     
[115] "r_ID[10215,Intercept]"      "r_ID[10216,Intercept]"     
[117] "r_ID[10217,Intercept]"      "r_ID[10219,Intercept]"     
[119] "r_ID[10220,Intercept]"      "r_ID[10221,Intercept]"     
[121] "r_ID[10222,Intercept]"      "r_ID[10223,Intercept]"     
[123] "r_ID[10226,Intercept]"      "r_ID[10227,Intercept]"     
[125] "r_ID[10228,Intercept]"      "r_ID[10229,Intercept]"     
[127] "r_ID[10230,Intercept]"      "r_ID[10231,Intercept]"     
[129] "r_ID[10232,Intercept]"      "r_ID[10233,Intercept]"     
[131] "r_ID[10234,Intercept]"      "r_ID[10236,Intercept]"     
[133] "r_ID[10237,Intercept]"      "r_ID[10238,Intercept]"     
[135] "r_ID[10239,Intercept]"      "r_ID[10240,Intercept]"     
[137] "r_ID[10241,Intercept]"      "r_ID[10242,Intercept]"     
[139] "r_ID[10243,Intercept]"      "r_ID[10244,Intercept]"     
[141] "r_ID[10245,Intercept]"      "r_ID[10247,Intercept]"     
[143] "r_ID[10248,Intercept]"      "r_ID[10249,Intercept]"     
[145] "r_ID[10250,Intercept]"      "r_ID[10251,Intercept]"     
[147] "r_ID[10253,Intercept]"      "r_ID[10255,Intercept]"     
[149] "r_ID[10256,Intercept]"      "r_ID[10258,Intercept]"     
[151] "r_ID[10259,Intercept]"      "r_ID[10260,Intercept]"     
[153] "r_ID[10266,Intercept]"      "r_ID[10267,Intercept]"     
[155] "r_ID[10268,Intercept]"      "r_ID[10269,Intercept]"     
[157] "r_ID[10270,Intercept]"      "r_ID[10271,Intercept]"     
[159] "r_ID[10272,Intercept]"      "r_ID[10273,Intercept]"     
[161] "r_ID[10274,Intercept]"      "r_ID[10275,Intercept]"     
[163] "r_ID[10276,Intercept]"      "r_ID[10277,Intercept]"     
[165] "r_ID[10280,Intercept]"      "r_ID[10281,Intercept]"     
[167] "r_ID[10285,Intercept]"      "r_ID[10286,Intercept]"     
[169] "r_ID[10287,Intercept]"      "r_ID[10288,Intercept]"     
[171] "r_ID[10289,Intercept]"      "r_ID[10290,Intercept]"     
[173] "r_ID[10291,Intercept]"      "r_ID[10292,Intercept]"     
[175] "r_ID[10293,Intercept]"      "r_ID[10294,Intercept]"     
[177] "r_ID[10295,Intercept]"      "r_ID[10296,Intercept]"     
[179] "r_ID[10299,Intercept]"      "r_ID[10301,Intercept]"     
[181] "r_ID[10304,Intercept]"      "r_ID[10305,Intercept]"     
[183] "r_ID[10308,Intercept]"      "r_ID[10309,Intercept]"     
[185] "r_ID[10310,Intercept]"      "r_ID[10311,Intercept]"     
[187] "r_ID[10312,Intercept]"      "r_ID[10313,Intercept]"     
[189] "r_ID[10314,Intercept]"      "r_ID[10315,Intercept]"     
[191] "r_ID[10316,Intercept]"      "r_ID[10317,Intercept]"     
[193] "r_ID[10318,Intercept]"      "r_ID[10319,Intercept]"     
[195] "r_ID[10320,Intercept]"      "r_ID[10322,Intercept]"     
[197] "r_ID[10323,Intercept]"      "r_ID[10324,Intercept]"     
[199] "r_ID[10325,Intercept]"      "r_ID[10326,Intercept]"     
[201] "r_ID[10327,Intercept]"      "r_ID[10328,Intercept]"     
[203] "r_ID[10329,Intercept]"      "r_ID[10330,Intercept]"     
[205] "r_ID[10331,Intercept]"      "r_ID[10332,Intercept]"     
[207] "r_ID[10333,Intercept]"      "r_ID[10335,Intercept]"     
[209] "r_ID[10336,Intercept]"      "r_ID[10337,Intercept]"     
[211] "r_ID[10338,Intercept]"      "r_ID[10340,Intercept]"     
[213] "r_ID[10341,Intercept]"      "r_ID[10342,Intercept]"     
[215] "r_ID[10343,Intercept]"      "r_ID[10345,Intercept]"     
[217] "r_ID[10347,Intercept]"      "r_ID[10348,Intercept]"     
[219] "r_ID[10349,Intercept]"      "r_ID[10350,Intercept]"     
[221] "r_ID[10351,Intercept]"      "r_ID[10352,Intercept]"     
[223] "r_ID[10353,Intercept]"      "r_ID[10354,Intercept]"     
[225] "r_ID[10357,Intercept]"      "r_ID[10358,Intercept]"     
[227] "r_ID[10359,Intercept]"      "r_ID[10360,Intercept]"     
[229] "r_ID[10361,Intercept]"      "r_ID[10363,Intercept]"     
[231] "r_ID[10364,Intercept]"      "r_ID[10365,Intercept]"     
[233] "r_ID[10366,Intercept]"      "r_ID[10367,Intercept]"     
[235] "r_ID[10368,Intercept]"      "r_ID[10369,Intercept]"     
[237] "r_ID[10370,Intercept]"      "r_ID[10371,Intercept]"     
[239] "r_ID[10372,Intercept]"      "r_ID[10373,Intercept]"     
[241] "r_ID[10374,Intercept]"      "r_ID[10378,Intercept]"     
[243] "r_ID[10379,Intercept]"      "r_ID[10380,Intercept]"     
[245] "r_ID[10381,Intercept]"      "r_ID[10382,Intercept]"     
[247] "r_ID[10383,Intercept]"      "r_ID[10384,Intercept]"     
[249] "r_ID[10386,Intercept]"      "r_ID[10388,Intercept]"     
[251] "r_ID[10389,Intercept]"      "r_ID[10390,Intercept]"     
[253] "r_ID[10391,Intercept]"      "r_ID[10392,Intercept]"     
[255] "r_ID[10394,Intercept]"      "r_ID[10397,Intercept]"     
[257] "r_ID[10398,Intercept]"      "r_ID[10399,Intercept]"     
[259] "r_ID[10402,Intercept]"      "r_ID[10404,Intercept]"     
[261] "r_ID[10407,Intercept]"      "r_ID[10408,Intercept]"     
[263] "r_ID[10409,Intercept]"      "r_ID[10411,Intercept]"     
[265] "r_ID[10412,Intercept]"      "r_ID[10413,Intercept]"     
[267] "r_ID[10414,Intercept]"      "r_ID[10415,Intercept]"     
[269] "r_ID[10418,Intercept]"      "r_ID[10421,Intercept]"     
[271] "r_ID[10422,Intercept]"      "r_ID[10423,Intercept]"     
[273] "r_ID[10426,Intercept]"      "r_ID[10427,Intercept]"     
[275] "r_ID[10428,Intercept]"      "r_ID[10429,Intercept]"     
[277] "r_ID[10431,Intercept]"      "r_ID[10432,Intercept]"     
[279] "r_ID[10433,Intercept]"      "r_ID[10434,Intercept]"     
[281] "r_ID[10435,Intercept]"      "r_ID[10436,Intercept]"     
[283] "r_ID[10437,Intercept]"      "r_ID[10438,Intercept]"     
[285] "r_ID[10439,Intercept]"      "r_ID[10440,Intercept]"     
[287] "r_ID[10441,Intercept]"      "r_ID[10442,Intercept]"     
[289] "r_ID[10444,Intercept]"      "r_ID[10445,Intercept]"     
[291] "r_ID[10447,Intercept]"      "r_ID[10448,Intercept]"     
[293] "r_ID[10449,Intercept]"      "r_ID[10450,Intercept]"     
[295] "r_ID[10451,Intercept]"      "r_ID[10452,Intercept]"     
[297] "r_ID[10453,Intercept]"      "r_ID[10454,Intercept]"     
[299] "r_ID[10455,Intercept]"      "r_ID[10456,Intercept]"     
[301] "r_ID[10457,Intercept]"      "r_ID[10459,Intercept]"     
[303] "r_ID[10460,Intercept]"      "r_ID[10461,Intercept]"     
[305] "r_ID[10462,Intercept]"      "r_ID[10463,Intercept]"     
[307] "r_ID[10465,Intercept]"      "r_ID[10466,Intercept]"     
[309] "r_ID[10469,Intercept]"      "r_ID[10470,Intercept]"     
[311] "r_ID[10471,Intercept]"      "r_ID[10472,Intercept]"     
[313] "r_ID[10473,Intercept]"      "r_ID[10474,Intercept]"     
[315] "r_ID[10475,Intercept]"      "r_ID[10476,Intercept]"     
[317] "r_ID[10477,Intercept]"      "r_ID[10479,Intercept]"     
[319] "r_ID[10480,Intercept]"      "r_ID[10481,Intercept]"     
[321] "r_ID[10483,Intercept]"      "r_ID[10484,Intercept]"     
[323] "r_ID[10485,Intercept]"      "r_ID[10486,Intercept]"     
[325] "r_ID[10487,Intercept]"      "r_ID[10488,Intercept]"     
[327] "r_ID[10490,Intercept]"      "r_ID[10492,Intercept]"     
[329] "r_ID[10493,Intercept]"      "r_ID[10494,Intercept]"     
[331] "r_ID[10495,Intercept]"      "r_ID[10496,Intercept]"     
[333] "r_ID[10497,Intercept]"      "r_ID[10498,Intercept]"     
[335] "r_ID[10500,Intercept]"      "r_ID[10503,Intercept]"     
[337] "r_ID[10506,Intercept]"      "r_ID[10508,Intercept]"     
[339] "r_ID[10509,Intercept]"      "r_ID[10510,Intercept]"     
[341] "r_ID[10511,Intercept]"      "r_ID[10512,Intercept]"     
[343] "r_ID[10513,Intercept]"      "r_ID[10515,Intercept]"     
[345] "r_ID[10516,Intercept]"      "r_ID[10517,Intercept]"     
[347] "r_ID[10518,Intercept]"      "r_ID[10522,Intercept]"     
[349] "r_ID[10523,Intercept]"      "r_ID[10524,Intercept]"     
[351] "r_ID[10525,Intercept]"      "r_ID[10526,Intercept]"     
[353] "r_ID[10528,Intercept]"      "r_ID[10529,Intercept]"     
[355] "r_ID[10530,Intercept]"      "r_ID[10532,Intercept]"     
[357] "r_ID[10533,Intercept]"      "r_ID[10535,Intercept]"     
[359] "r_ID[10536,Intercept]"      "r_ID[10537,Intercept]"     
[361] "r_ID[10538,Intercept]"      "r_ID[10539,Intercept]"     
[363] "r_ID[10540,Intercept]"      "r_ID[10541,Intercept]"     
[365] "r_ID[10542,Intercept]"      "r_ID[10543,Intercept]"     
[367] "r_ID[10544,Intercept]"      "r_ID[10545,Intercept]"     
[369] "r_ID[10547,Intercept]"      "r_ID[10549,Intercept]"     
[371] "r_ID[10550,Intercept]"      "r_ID[81,W.other]"          
[373] "r_ID[86,W.other]"           "r_ID[87,W.other]"          
[375] "r_ID[88,W.other]"           "r_ID[89,W.other]"          
[377] "r_ID[90,W.other]"           "r_ID[91,W.other]"          
[379] "r_ID[92,W.other]"           "r_ID[93,W.other]"          
[381] "r_ID[94,W.other]"           "r_ID[95,W.other]"          
[383] "r_ID[97,W.other]"           "r_ID[98,W.other]"          
[385] "r_ID[100,W.other]"          "r_ID[101,W.other]"         
[387] "r_ID[102,W.other]"          "r_ID[104,W.other]"         
[389] "r_ID[10105,W.other]"        "r_ID[10106,W.other]"       
[391] "r_ID[10107,W.other]"        "r_ID[10108,W.other]"       
[393] "r_ID[10109,W.other]"        "r_ID[10110,W.other]"       
[395] "r_ID[10111,W.other]"        "r_ID[10112,W.other]"       
[397] "r_ID[10113,W.other]"        "r_ID[10114,W.other]"       
[399] "r_ID[10116,W.other]"        "r_ID[10117,W.other]"       
[401] "r_ID[10118,W.other]"        "r_ID[10121,W.other]"       
[403] "r_ID[10122,W.other]"        "r_ID[10123,W.other]"       
[405] "r_ID[10124,W.other]"        "r_ID[10125,W.other]"       
[407] "r_ID[10126,W.other]"        "r_ID[10127,W.other]"       
[409] "r_ID[10128,W.other]"        "r_ID[10129,W.other]"       
[411] "r_ID[10130,W.other]"        "r_ID[10131,W.other]"       
[413] "r_ID[10132,W.other]"        "r_ID[10133,W.other]"       
[415] "r_ID[10134,W.other]"        "r_ID[10136,W.other]"       
[417] "r_ID[10137,W.other]"        "r_ID[10138,W.other]"       
[419] "r_ID[10139,W.other]"        "r_ID[10141,W.other]"       
[421] "r_ID[10143,W.other]"        "r_ID[10144,W.other]"       
[423] "r_ID[10145,W.other]"        "r_ID[10147,W.other]"       
[425] "r_ID[10148,W.other]"        "r_ID[10149,W.other]"       
[427] "r_ID[10150,W.other]"        "r_ID[10151,W.other]"       
[429] "r_ID[10153,W.other]"        "r_ID[10154,W.other]"       
[431] "r_ID[10155,W.other]"        "r_ID[10157,W.other]"       
[433] "r_ID[10158,W.other]"        "r_ID[10159,W.other]"       
[435] "r_ID[10160,W.other]"        "r_ID[10161,W.other]"       
[437] "r_ID[10162,W.other]"        "r_ID[10164,W.other]"       
[439] "r_ID[10166,W.other]"        "r_ID[10167,W.other]"       
[441] "r_ID[10171,W.other]"        "r_ID[10172,W.other]"       
[443] "r_ID[10173,W.other]"        "r_ID[10174,W.other]"       
[445] "r_ID[10175,W.other]"        "r_ID[10176,W.other]"       
[447] "r_ID[10177,W.other]"        "r_ID[10178,W.other]"       
[449] "r_ID[10180,W.other]"        "r_ID[10181,W.other]"       
[451] "r_ID[10184,W.other]"        "r_ID[10185,W.other]"       
[453] "r_ID[10186,W.other]"        "r_ID[10187,W.other]"       
[455] "r_ID[10188,W.other]"        "r_ID[10190,W.other]"       
[457] "r_ID[10192,W.other]"        "r_ID[10193,W.other]"       
[459] "r_ID[10194,W.other]"        "r_ID[10195,W.other]"       
[461] "r_ID[10196,W.other]"        "r_ID[10197,W.other]"       
[463] "r_ID[10198,W.other]"        "r_ID[10199,W.other]"       
[465] "r_ID[10200,W.other]"        "r_ID[10201,W.other]"       
[467] "r_ID[10202,W.other]"        "r_ID[10203,W.other]"       
[469] "r_ID[10204,W.other]"        "r_ID[10205,W.other]"       
[471] "r_ID[10206,W.other]"        "r_ID[10207,W.other]"       
[473] "r_ID[10208,W.other]"        "r_ID[10210,W.other]"       
[475] "r_ID[10211,W.other]"        "r_ID[10212,W.other]"       
[477] "r_ID[10213,W.other]"        "r_ID[10214,W.other]"       
[479] "r_ID[10215,W.other]"        "r_ID[10216,W.other]"       
[481] "r_ID[10217,W.other]"        "r_ID[10219,W.other]"       
[483] "r_ID[10220,W.other]"        "r_ID[10221,W.other]"       
[485] "r_ID[10222,W.other]"        "r_ID[10223,W.other]"       
[487] "r_ID[10226,W.other]"        "r_ID[10227,W.other]"       
[489] "r_ID[10228,W.other]"        "r_ID[10229,W.other]"       
[491] "r_ID[10230,W.other]"        "r_ID[10231,W.other]"       
[493] "r_ID[10232,W.other]"        "r_ID[10233,W.other]"       
[495] "r_ID[10234,W.other]"        "r_ID[10236,W.other]"       
[497] "r_ID[10237,W.other]"        "r_ID[10238,W.other]"       
[499] "r_ID[10239,W.other]"        "r_ID[10240,W.other]"       
[501] "r_ID[10241,W.other]"        "r_ID[10242,W.other]"       
[503] "r_ID[10243,W.other]"        "r_ID[10244,W.other]"       
[505] "r_ID[10245,W.other]"        "r_ID[10247,W.other]"       
[507] "r_ID[10248,W.other]"        "r_ID[10249,W.other]"       
[509] "r_ID[10250,W.other]"        "r_ID[10251,W.other]"       
[511] "r_ID[10253,W.other]"        "r_ID[10255,W.other]"       
[513] "r_ID[10256,W.other]"        "r_ID[10258,W.other]"       
[515] "r_ID[10259,W.other]"        "r_ID[10260,W.other]"       
[517] "r_ID[10266,W.other]"        "r_ID[10267,W.other]"       
[519] "r_ID[10268,W.other]"        "r_ID[10269,W.other]"       
[521] "r_ID[10270,W.other]"        "r_ID[10271,W.other]"       
[523] "r_ID[10272,W.other]"        "r_ID[10273,W.other]"       
[525] "r_ID[10274,W.other]"        "r_ID[10275,W.other]"       
[527] "r_ID[10276,W.other]"        "r_ID[10277,W.other]"       
[529] "r_ID[10280,W.other]"        "r_ID[10281,W.other]"       
[531] "r_ID[10285,W.other]"        "r_ID[10286,W.other]"       
[533] "r_ID[10287,W.other]"        "r_ID[10288,W.other]"       
[535] "r_ID[10289,W.other]"        "r_ID[10290,W.other]"       
[537] "r_ID[10291,W.other]"        "r_ID[10292,W.other]"       
[539] "r_ID[10293,W.other]"        "r_ID[10294,W.other]"       
[541] "r_ID[10295,W.other]"        "r_ID[10296,W.other]"       
[543] "r_ID[10299,W.other]"        "r_ID[10301,W.other]"       
[545] "r_ID[10304,W.other]"        "r_ID[10305,W.other]"       
[547] "r_ID[10308,W.other]"        "r_ID[10309,W.other]"       
[549] "r_ID[10310,W.other]"        "r_ID[10311,W.other]"       
[551] "r_ID[10312,W.other]"        "r_ID[10313,W.other]"       
[553] "r_ID[10314,W.other]"        "r_ID[10315,W.other]"       
[555] "r_ID[10316,W.other]"        "r_ID[10317,W.other]"       
[557] "r_ID[10318,W.other]"        "r_ID[10319,W.other]"       
[559] "r_ID[10320,W.other]"        "r_ID[10322,W.other]"       
[561] "r_ID[10323,W.other]"        "r_ID[10324,W.other]"       
[563] "r_ID[10325,W.other]"        "r_ID[10326,W.other]"       
[565] "r_ID[10327,W.other]"        "r_ID[10328,W.other]"       
[567] "r_ID[10329,W.other]"        "r_ID[10330,W.other]"       
[569] "r_ID[10331,W.other]"        "r_ID[10332,W.other]"       
[571] "r_ID[10333,W.other]"        "r_ID[10335,W.other]"       
[573] "r_ID[10336,W.other]"        "r_ID[10337,W.other]"       
[575] "r_ID[10338,W.other]"        "r_ID[10340,W.other]"       
[577] "r_ID[10341,W.other]"        "r_ID[10342,W.other]"       
[579] "r_ID[10343,W.other]"        "r_ID[10345,W.other]"       
[581] "r_ID[10347,W.other]"        "r_ID[10348,W.other]"       
[583] "r_ID[10349,W.other]"        "r_ID[10350,W.other]"       
[585] "r_ID[10351,W.other]"        "r_ID[10352,W.other]"       
[587] "r_ID[10353,W.other]"        "r_ID[10354,W.other]"       
[589] "r_ID[10357,W.other]"        "r_ID[10358,W.other]"       
[591] "r_ID[10359,W.other]"        "r_ID[10360,W.other]"       
[593] "r_ID[10361,W.other]"        "r_ID[10363,W.other]"       
[595] "r_ID[10364,W.other]"        "r_ID[10365,W.other]"       
[597] "r_ID[10366,W.other]"        "r_ID[10367,W.other]"       
[599] "r_ID[10368,W.other]"        "r_ID[10369,W.other]"       
[601] "r_ID[10370,W.other]"        "r_ID[10371,W.other]"       
[603] "r_ID[10372,W.other]"        "r_ID[10373,W.other]"       
[605] "r_ID[10374,W.other]"        "r_ID[10378,W.other]"       
[607] "r_ID[10379,W.other]"        "r_ID[10380,W.other]"       
[609] "r_ID[10381,W.other]"        "r_ID[10382,W.other]"       
[611] "r_ID[10383,W.other]"        "r_ID[10384,W.other]"       
[613] "r_ID[10386,W.other]"        "r_ID[10388,W.other]"       
[615] "r_ID[10389,W.other]"        "r_ID[10390,W.other]"       
[617] "r_ID[10391,W.other]"        "r_ID[10392,W.other]"       
[619] "r_ID[10394,W.other]"        "r_ID[10397,W.other]"       
[621] "r_ID[10398,W.other]"        "r_ID[10399,W.other]"       
[623] "r_ID[10402,W.other]"        "r_ID[10404,W.other]"       
[625] "r_ID[10407,W.other]"        "r_ID[10408,W.other]"       
[627] "r_ID[10409,W.other]"        "r_ID[10411,W.other]"       
[629] "r_ID[10412,W.other]"        "r_ID[10413,W.other]"       
[631] "r_ID[10414,W.other]"        "r_ID[10415,W.other]"       
[633] "r_ID[10418,W.other]"        "r_ID[10421,W.other]"       
[635] "r_ID[10422,W.other]"        "r_ID[10423,W.other]"       
[637] "r_ID[10426,W.other]"        "r_ID[10427,W.other]"       
[639] "r_ID[10428,W.other]"        "r_ID[10429,W.other]"       
[641] "r_ID[10431,W.other]"        "r_ID[10432,W.other]"       
[643] "r_ID[10433,W.other]"        "r_ID[10434,W.other]"       
[645] "r_ID[10435,W.other]"        "r_ID[10436,W.other]"       
[647] "r_ID[10437,W.other]"        "r_ID[10438,W.other]"       
[649] "r_ID[10439,W.other]"        "r_ID[10440,W.other]"       
[651] "r_ID[10441,W.other]"        "r_ID[10442,W.other]"       
[653] "r_ID[10444,W.other]"        "r_ID[10445,W.other]"       
[655] "r_ID[10447,W.other]"        "r_ID[10448,W.other]"       
[657] "r_ID[10449,W.other]"        "r_ID[10450,W.other]"       
[659] "r_ID[10451,W.other]"        "r_ID[10452,W.other]"       
[661] "r_ID[10453,W.other]"        "r_ID[10454,W.other]"       
[663] "r_ID[10455,W.other]"        "r_ID[10456,W.other]"       
[665] "r_ID[10457,W.other]"        "r_ID[10459,W.other]"       
[667] "r_ID[10460,W.other]"        "r_ID[10461,W.other]"       
[669] "r_ID[10462,W.other]"        "r_ID[10463,W.other]"       
[671] "r_ID[10465,W.other]"        "r_ID[10466,W.other]"       
[673] "r_ID[10469,W.other]"        "r_ID[10470,W.other]"       
[675] "r_ID[10471,W.other]"        "r_ID[10472,W.other]"       
[677] "r_ID[10473,W.other]"        "r_ID[10474,W.other]"       
[679] "r_ID[10475,W.other]"        "r_ID[10476,W.other]"       
[681] "r_ID[10477,W.other]"        "r_ID[10479,W.other]"       
[683] "r_ID[10480,W.other]"        "r_ID[10481,W.other]"       
[685] "r_ID[10483,W.other]"        "r_ID[10484,W.other]"       
[687] "r_ID[10485,W.other]"        "r_ID[10486,W.other]"       
[689] "r_ID[10487,W.other]"        "r_ID[10488,W.other]"       
[691] "r_ID[10490,W.other]"        "r_ID[10492,W.other]"       
[693] "r_ID[10493,W.other]"        "r_ID[10494,W.other]"       
[695] "r_ID[10495,W.other]"        "r_ID[10496,W.other]"       
[697] "r_ID[10497,W.other]"        "r_ID[10498,W.other]"       
[699] "r_ID[10500,W.other]"        "r_ID[10503,W.other]"       
[701] "r_ID[10506,W.other]"        "r_ID[10508,W.other]"       
[703] "r_ID[10509,W.other]"        "r_ID[10510,W.other]"       
[705] "r_ID[10511,W.other]"        "r_ID[10512,W.other]"       
[707] "r_ID[10513,W.other]"        "r_ID[10515,W.other]"       
[709] "r_ID[10516,W.other]"        "r_ID[10517,W.other]"       
[711] "r_ID[10518,W.other]"        "r_ID[10522,W.other]"       
[713] "r_ID[10523,W.other]"        "r_ID[10524,W.other]"       
[715] "r_ID[10525,W.other]"        "r_ID[10526,W.other]"       
[717] "r_ID[10528,W.other]"        "r_ID[10529,W.other]"       
[719] "r_ID[10530,W.other]"        "r_ID[10532,W.other]"       
[721] "r_ID[10533,W.other]"        "r_ID[10535,W.other]"       
[723] "r_ID[10536,W.other]"        "r_ID[10537,W.other]"       
[725] "r_ID[10538,W.other]"        "r_ID[10539,W.other]"       
[727] "r_ID[10540,W.other]"        "r_ID[10541,W.other]"       
[729] "r_ID[10542,W.other]"        "r_ID[10543,W.other]"       
[731] "r_ID[10544,W.other]"        "r_ID[10545,W.other]"       
[733] "r_ID[10547,W.other]"        "r_ID[10549,W.other]"       
[735] "r_ID[10550,W.other]"        "prior_Intercept"           
[737] "prior_b"                    "prior_sigma"               
[739] "prior_sd_ID__Intercept"     "prior_sd_ID__W.other"      
[741] "prior_cor_ID"               "lprior"                    
[743] "lp__"                       "accept_stat__"             
[745] "treedepth__"                "stepsize__"                
[747] "divergent__"                "n_leapfrog__"              
[749] "energy__"                  </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">summary</span>(mlm<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: PA ~ 1 + W.other + (1 + W.other | ID) 
   Data: esm (Number of observations: 9461) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Multilevel Hyperparameters:
~ID (Number of levels: 364) 
                       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)              0.50      0.03     0.44     0.55 1.00     4161
sd(W.other)                0.18      0.04     0.10     0.26 1.01     1183
cor(Intercept,W.other)    -0.43      0.11    -0.63    -0.19 1.00    10059
                       Tail_ESS
sd(Intercept)              6764
sd(W.other)                1586
cor(Intercept,W.other)     7217

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     3.15      0.04     3.08     3.22 1.00     4920     8033
W.other       0.32      0.03     0.27     0.37 1.00    13873    10128

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.85      0.01     0.84     0.86 1.00    14748     7743

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>partially_pooled_params2 <span class="ot">&lt;-</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>  <span class="fu">coef</span>(mlm<span class="fl">.5</span>)<span class="sc">$</span>ID [ , <span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ID"</span>) </span>
<span id="cb83-4"><a href="#cb83-4"></a></span>
<span id="cb83-5"><a href="#cb83-5"></a></span>
<span id="cb83-6"><a href="#cb83-6"></a>un_pooled_params <span class="ot">&lt;-</span></span>
<span id="cb83-7"><a href="#cb83-7"></a>  esm <span class="sc">%&gt;%</span></span>
<span id="cb83-8"><a href="#cb83-8"></a>  <span class="fu">filter</span>((<span class="sc">!</span><span class="fu">is.na</span>(PA))) <span class="sc">%&gt;%</span> </span>
<span id="cb83-9"><a href="#cb83-9"></a>  <span class="fu">group_by</span>(ID, W.other) <span class="sc">%&gt;%</span></span>
<span id="cb83-10"><a href="#cb83-10"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(PA)) <span class="sc">%&gt;%</span></span>
<span id="cb83-11"><a href="#cb83-11"></a>  <span class="fu">do</span>(<span class="fu">tidy</span>(<span class="fu">lm</span>(mean <span class="sc">~</span> W.other, <span class="at">data=</span>.))) <span class="sc">%&gt;%</span> </span>
<span id="cb83-12"><a href="#cb83-12"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb83-13"><a href="#cb83-13"></a>  <span class="fu">select</span>(ID, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb83-14"><a href="#cb83-14"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb83-15"><a href="#cb83-15"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-16"><a href="#cb83-16"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-17"><a href="#cb83-17"></a>  <span class="co">#select(-`Intercept`) %&gt;% </span></span>
<span id="cb83-18"><a href="#cb83-18"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID))</span>
<span id="cb83-19"><a href="#cb83-19"></a></span>
<span id="cb83-20"><a href="#cb83-20"></a>params <span class="ot">&lt;-</span></span>
<span id="cb83-21"><a href="#cb83-21"></a>  <span class="co"># `bind_rows()` will stack the second tibble below the first</span></span>
<span id="cb83-22"><a href="#cb83-22"></a>  <span class="fu">bind_rows</span>(partially_pooled_params2, un_pooled_params) <span class="sc">%&gt;%</span></span>
<span id="cb83-23"><a href="#cb83-23"></a>  <span class="co"># index whether the estimates are pooled</span></span>
<span id="cb83-24"><a href="#cb83-24"></a>  <span class="fu">mutate</span>(<span class="at">pooled =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"partially"</span>, <span class="st">"not"</span>), <span class="at">each =</span> <span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">2</span>)) </span>
<span id="cb83-25"><a href="#cb83-25"></a></span>
<span id="cb83-26"><a href="#cb83-26"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb83-27"><a href="#cb83-27"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> params, <span class="fu">aes</span>(<span class="at">x =</span> W.other, <span class="at">y =</span> Intercept)) <span class="sc">+</span></span>
<span id="cb83-28"><a href="#cb83-28"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID, <span class="at">color =</span> pooled)) <span class="sc">+</span></span>
<span id="cb83-29"><a href="#cb83-29"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID), <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb83-30"><a href="#cb83-30"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Pooled?"</span>,</span>
<span id="cb83-31"><a href="#cb83-31"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#80A0C7"</span>, <span class="st">"#A65141"</span>)) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">1</span>) </span>
<span id="cb83-32"><a href="#cb83-32"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-64-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>mlm<span class="fl">.5</span> <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2"></a>  <span class="fu">spread_draws</span>(b_W.other, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"W.other"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb84-4"><a href="#cb84-4"></a>  <span class="fu">median_qi</span>(<span class="at">person_t =</span> b_W.other <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb84-5"><a href="#cb84-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">y =</span> <span class="fu">reorder</span>(ID, person_t), <span class="at">x =</span> person_t, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb84-6"><a href="#cb84-6"></a>  <span class="fu">geom_pointinterval</span>(<span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"est"</span>)  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb84-7"><a href="#cb84-7"></a>        <span class="at">axis.text.y=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-65-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>esm <span class="ot">&lt;-</span> esm <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb85-3"><a href="#cb85-3"></a><span class="fu">mutate</span>(<span class="at">W.other.pm =</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">W.other</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-4"><a href="#cb85-4"></a><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb85-5"><a href="#cb85-5"></a><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(W.other.pm)) <span class="sc">%&gt;%</span>   </span>
<span id="cb85-6"><a href="#cb85-6"></a><span class="fu">mutate</span>(<span class="at">W.other.pc =</span> W.other <span class="sc">-</span> W.other.pm) <span class="sc">%&gt;%</span> </span>
<span id="cb85-7"><a href="#cb85-7"></a><span class="fu">mutate</span>(<span class="at">W.other.gmc =</span>W.other.pm  <span class="sc">-</span> <span class="fu">mean</span> (W.other.pm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>mlm<span class="fl">.6</span> <span class="ot">&lt;-</span> </span>
<span id="cb86-2"><a href="#cb86-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb86-3"><a href="#cb86-3"></a>      PA <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> W.other.pc  <span class="sc">+</span>  W.other.gmc <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> W.other.pc  <span class="sc">|</span> ID),</span>
<span id="cb86-4"><a href="#cb86-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb86-5"><a href="#cb86-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb86-6"><a href="#cb86-6"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> Intercept, <span class="at">group =</span> ID), </span>
<span id="cb86-7"><a href="#cb86-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> W.other.pc, <span class="at">group =</span> ID), </span>
<span id="cb86-8"><a href="#cb86-8"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb86-9"><a href="#cb86-9"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">10</span>), <span class="at">class =</span> cor)),</span>
<span id="cb86-10"><a href="#cb86-10"></a>      <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb86-11"><a href="#cb86-11"></a>      <span class="at">file =</span> <span class="st">"mlm.6"</span>,</span>
<span id="cb86-12"><a href="#cb86-12"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb86-13"><a href="#cb86-13"></a>      <span class="at">data =</span> esm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="fu">summary</span>(mlm<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: PA ~ 1 + W.other.pc + W.other.gmc + (1 + W.other.pc | ID) 
   Data: esm (Number of observations: 8321) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Multilevel Hyperparameters:
~ID (Number of levels: 326) 
                          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)                 0.46      0.02     0.41     0.50 1.00     2349
sd(W.other.pc)                0.19      0.04     0.11     0.27 1.00     3472
cor(Intercept,W.other.pc)    -0.26      0.13    -0.51     0.00 1.00     9946
                          Tail_ESS
sd(Intercept)                 4181
sd(W.other.pc)                4015
cor(Intercept,W.other.pc)     9398

Regression Coefficients:
            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept       3.40      0.03     3.35     3.45 1.00     1713     3751
W.other.pc      0.33      0.03     0.28     0.39 1.00    12668     9342
W.other.gmc     0.85      0.18     0.50     1.22 1.00     2307     3904

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.86      0.01     0.84     0.87 1.00    17621     8652

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>partially_pooled_params3 <span class="ot">&lt;-</span></span>
<span id="cb89-2"><a href="#cb89-2"></a>  <span class="fu">coef</span>(mlm<span class="fl">.6</span>)<span class="sc">$</span>ID [ , <span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="#cb89-3"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"ID"</span>) </span>
<span id="cb89-4"><a href="#cb89-4"></a></span>
<span id="cb89-5"><a href="#cb89-5"></a></span>
<span id="cb89-6"><a href="#cb89-6"></a>un_pooled_params2 <span class="ot">&lt;-</span></span>
<span id="cb89-7"><a href="#cb89-7"></a>  esm <span class="sc">%&gt;%</span></span>
<span id="cb89-8"><a href="#cb89-8"></a>  <span class="fu">filter</span>((<span class="sc">!</span><span class="fu">is.na</span>(PA))) <span class="sc">%&gt;%</span> </span>
<span id="cb89-9"><a href="#cb89-9"></a>  <span class="fu">group_by</span>(ID, W.other.pc) <span class="sc">%&gt;%</span></span>
<span id="cb89-10"><a href="#cb89-10"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(PA)) <span class="sc">%&gt;%</span></span>
<span id="cb89-11"><a href="#cb89-11"></a>  <span class="fu">do</span>(<span class="fu">tidy</span>(<span class="fu">lm</span>(mean <span class="sc">~</span> W.other.pc, <span class="at">data=</span>.))) <span class="sc">%&gt;%</span> </span>
<span id="cb89-12"><a href="#cb89-12"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb89-13"><a href="#cb89-13"></a>  <span class="fu">select</span>(ID, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb89-14"><a href="#cb89-14"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> term, <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb89-15"><a href="#cb89-15"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-16"><a href="#cb89-16"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-17"><a href="#cb89-17"></a>  <span class="co">#select(-`Intercept`) %&gt;% </span></span>
<span id="cb89-18"><a href="#cb89-18"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID))</span>
<span id="cb89-19"><a href="#cb89-19"></a></span>
<span id="cb89-20"><a href="#cb89-20"></a>params2 <span class="ot">&lt;-</span></span>
<span id="cb89-21"><a href="#cb89-21"></a>  <span class="co"># `bind_rows()` will stack the second tibble below the first</span></span>
<span id="cb89-22"><a href="#cb89-22"></a>  <span class="fu">bind_rows</span>(partially_pooled_params3, un_pooled_params2) <span class="sc">%&gt;%</span></span>
<span id="cb89-23"><a href="#cb89-23"></a>  <span class="co"># index whether the estimates are pooled</span></span>
<span id="cb89-24"><a href="#cb89-24"></a>  <span class="fu">mutate</span>(<span class="at">pooled =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"partially"</span>, <span class="st">"not"</span>), <span class="at">each =</span> <span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">2</span>)) </span>
<span id="cb89-25"><a href="#cb89-25"></a></span>
<span id="cb89-26"><a href="#cb89-26"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb89-27"><a href="#cb89-27"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> params2, <span class="fu">aes</span>(<span class="at">x =</span> W.other.pc, <span class="at">y =</span> Intercept, <span class="at">group =</span> pooled)) <span class="sc">+</span></span>
<span id="cb89-28"><a href="#cb89-28"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID, <span class="at">color =</span> pooled)) <span class="sc">+</span></span>
<span id="cb89-29"><a href="#cb89-29"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> ID), <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb89-30"><a href="#cb89-30"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"Pooled?"</span>,</span>
<span id="cb89-31"><a href="#cb89-31"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#80A0C7"</span>, <span class="st">"#A65141"</span>)) <span class="sc">+</span></span>
<span id="cb89-32"><a href="#cb89-32"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb89-33"><a href="#cb89-33"></a></span>
<span id="cb89-34"><a href="#cb89-34"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-69-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>mlm<span class="fl">.6</span> <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="#cb90-2"></a>  <span class="fu">spread_draws</span>(b_W.other.pc, r_ID[ID, term]) <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"W.other.pc"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb90-4"><a href="#cb90-4"></a>  <span class="fu">median_qi</span>(<span class="at">person_t =</span> b_W.other.pc <span class="sc">+</span> r_ID) <span class="sc">%&gt;%</span></span>
<span id="cb90-5"><a href="#cb90-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( <span class="at">y =</span> <span class="fu">reorder</span>(ID, person_t), <span class="at">x =</span> person_t, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper)) <span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6"></a>  <span class="fu">geom_pointinterval</span>(<span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"est"</span>)  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb90-7"><a href="#cb90-7"></a>        <span class="at">axis.text.y=</span><span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-70-1.png" width="960" class="r-stretch"></section>
<section id="mlm-plots" class="slide level2">
<h2>MLM plots</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>melsm <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/Library/CloudStorage/Box-Box/Bayesian Statistics/bayes22/static/Lectures/melsm.csv"</span>)</span>
<span id="cb91-2"><a href="#cb91-2"></a></span>
<span id="cb91-3"><a href="#cb91-3"></a>melsm <span class="ot">&lt;-</span> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb91-4"><a href="#cb91-4"></a>  <span class="fu">mutate</span>(<span class="at">day01 =</span> (day <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">max</span>((day <span class="sc">-</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="fu">distinct</span>(record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb92-3"><a href="#cb92-3"></a>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    n
1 193</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Participants filled out daily affective measures and physical activity</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb94-2"><a href="#cb94-2"></a>    <span class="fu">count</span>(record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb94-3"><a href="#cb94-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n)) <span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb94-5"><a href="#cb94-5"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"number of days"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-73-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Participant level</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="fu">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb95-2"><a href="#cb95-2"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb95-3"><a href="#cb95-3"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb95-4"><a href="#cb95-4"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="sc">!</span>record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb95-5"><a href="#cb95-5"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb95-6"><a href="#cb95-6"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb95-7"><a href="#cb95-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> N_A.lag)) <span class="sc">+</span></span>
<span id="cb95-8"><a href="#cb95-8"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb95-9"><a href="#cb95-9"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb95-10"><a href="#cb95-10"></a>  <span class="fu">ylab</span>(<span class="st">"negative affect (standardized)"</span>) <span class="sc">+</span></span>
<span id="cb95-11"><a href="#cb95-11"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>record_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-74-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>day01 is coded such that it is a percentage of the 100 total possible days.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>melsm<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb96-2"><a href="#cb96-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb96-3"><a href="#cb96-3"></a>      N_A.std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span> record_id),</span>
<span id="cb96-4"><a href="#cb96-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb96-5"><a href="#cb96-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb96-6"><a href="#cb96-6"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb96-7"><a href="#cb96-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb96-8"><a href="#cb96-8"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb96-9"><a href="#cb96-9"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb96-10"><a href="#cb96-10"></a>      <span class="at">data =</span> melsm,</span>
<span id="cb96-11"><a href="#cb96-11"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb96-12"><a href="#cb96-12"></a>      <span class="at">file =</span> <span class="st">"melsm.1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="fu">summary</span>(melsm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: N_A.std ~ 1 + day01 + (1 + day01 | record_id) 
   Data: melsm (Number of observations: 13033) 
  Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~record_id (Number of levels: 193) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.77      0.04     0.70     0.86 1.00     1559
sd(day01)                0.65      0.05     0.57     0.74 1.00     3123
cor(Intercept,day01)    -0.34      0.08    -0.49    -0.19 1.00     2908
                     Tail_ESS
sd(Intercept)            2797
sd(day01)                5013
cor(Intercept,day01)     4769

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.03      0.06    -0.08     0.14 1.01      711     1390
day01        -0.16      0.06    -0.27    -0.05 1.00     2501     4239

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.61      0.00     0.60     0.62 1.00    13505     5554

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>We have to be careful with plotting MLMs</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb99-2"><a href="#cb99-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), <span class="at">.model=</span> melsm) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 9
    day01 P_A.std   day P_A.lag N_A.lag steps.pm steps.pmd record_id N_A.std
    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 0       0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 2 0.0526  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 3 0.105   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 4 0.158   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 5 0.211   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 6 0.263   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 7 0.316   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 8 0.368   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 9 0.421   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
10 0.474   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
11 0.526   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
12 0.579   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
13 0.632   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
14 0.684   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
15 0.737   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
16 0.789   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
17 0.842   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
18 0.895   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
19 0.947   0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
20 1       0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="#cb101-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), <span class="at">.model=</span> melsm) <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="#cb101-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160,000 × 14
# Groups:   day01, P_A.std, day, P_A.lag, N_A.lag, steps.pm, steps.pmd,
#   record_id, N_A.std, .row [20]
   day01 P_A.std   day P_A.lag N_A.lag steps.pm steps.pmd record_id N_A.std
   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 2     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 3     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 4     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 5     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 6     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 7     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 8     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
 9     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
10     0  0.0141    41  0.0239  -0.418   0.0480 -0.000672        96  -0.351
# ℹ 159,990 more rows
# ℹ 5 more variables: .row &lt;int&gt;, .chain &lt;int&gt;, .iteration &lt;int&gt;, .draw &lt;int&gt;,
#   .epred &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>If we do not care about random effects, specify re_formula = NA</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>fixed.slope<span class="ot">&lt;-</span> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb103-2"><a href="#cb103-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-3"><a href="#cb103-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NA</span> )</span>
<span id="cb103-4"><a href="#cb103-4"></a>  fixed.slope</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160,000 × 6
# Groups:   day01, .row [20]
   day01  .row .chain .iteration .draw   .epred
   &lt;dbl&gt; &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;
 1     0     1     NA         NA     1 -0.00964
 2     0     1     NA         NA     2  0.0705 
 3     0     1     NA         NA     3  0.171  
 4     0     1     NA         NA     4  0.133  
 5     0     1     NA         NA     5  0.0913 
 6     0     1     NA         NA     6  0.0832 
 7     0     1     NA         NA     7  0.0691 
 8     0     1     NA         NA     8  0.111  
 9     0     1     NA         NA     9  0.121  
10     0     1     NA         NA    10  0.0866 
# ℹ 159,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>If we want random effects we need to specify the variable to get ALL levels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb105-2"><a href="#cb105-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,860 × 2
   day01 record_id
   &lt;dbl&gt;     &lt;int&gt;
 1     0         1
 2     0         2
 3     0         3
 4     0         4
 5     0         5
 6     0         6
 7     0         7
 8     0         8
 9     0         9
10     0        10
# ℹ 3,850 more rows</code></pre>
</div>
</div>
<p>193 people * 20 = 3860</p>
</section>
<section class="slide level2">

<p>Then we need to state re_forumla = NULL (which is the default)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb107-2"><a href="#cb107-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="#cb107-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NULL</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30,880,000 × 7
# Groups:   day01, record_id, .row [3,860]
   day01 record_id  .row .chain .iteration .draw .epred
   &lt;dbl&gt;     &lt;int&gt; &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
 1     0         1     1     NA         NA     1  0.186
 2     0         1     1     NA         NA     2  0.141
 3     0         1     1     NA         NA     3  0.126
 4     0         1     1     NA         NA     4  0.238
 5     0         1     1     NA         NA     5  0.216
 6     0         1     1     NA         NA     6  0.168
 7     0         1     1     NA         NA     7  0.148
 8     0         1     1     NA         NA     8  0.153
 9     0         1     1     NA         NA     9  0.228
10     0         1     1     NA         NA    10  0.183
# ℹ 30,879,990 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>re_formula formula helps us focus on either the average trajectory (gammas) or the group specific (person Us). If NULL (default), include all group-level effects; if NA, include no group-level effects.</p>
<p>160,000 = 20 (different values of X we chose) x 8000 iterations (2k x 4 chains)</p>
<p>30,880,000 = 20* 8000 iterations * 193 people in our dataset</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb109-2"><a href="#cb109-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb109-3"><a href="#cb109-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb109-4"><a href="#cb109-4"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb109-5"><a href="#cb109-5"></a>  <span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> .epred) <span class="sc">+</span></span>
<span id="cb109-6"><a href="#cb109-6"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fl">0.95</span>, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-82-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="do">## https://www.tjmahr.com/sample-n-groups/</span></span>
<span id="cb110-2"><a href="#cb110-2"></a>sample_n_of <span class="ot">&lt;-</span> <span class="cf">function</span>(data, size, ...) {</span>
<span id="cb110-3"><a href="#cb110-3"></a>  dots <span class="ot">&lt;-</span> <span class="fu">quos</span>(...)</span>
<span id="cb110-4"><a href="#cb110-4"></a>  group_ids <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb110-5"><a href="#cb110-5"></a>    <span class="fu">group_by</span>(<span class="sc">!!!</span> dots) <span class="sc">%&gt;%</span> </span>
<span id="cb110-6"><a href="#cb110-6"></a>    <span class="fu">group_indices</span>()</span>
<span id="cb110-7"><a href="#cb110-7"></a>  sampled_groups <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">unique</span>(group_ids), size)</span>
<span id="cb110-8"><a href="#cb110-8"></a>  data <span class="sc">%&gt;%</span> </span>
<span id="cb110-9"><a href="#cb110-9"></a>    <span class="fu">filter</span>(group_ids <span class="sc">%in%</span> sampled_groups)</span>
<span id="cb110-10"><a href="#cb110-10"></a>}</span>
<span id="cb110-11"><a href="#cb110-11"></a></span>
<span id="cb110-12"><a href="#cb110-12"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb110-13"><a href="#cb110-13"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb110-14"><a href="#cb110-14"></a>    <span class="fu">sample_n_of</span>(<span class="dv">5</span>,record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb110-15"><a href="#cb110-15"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb110-16"><a href="#cb110-16"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01)) <span class="sc">+</span></span>
<span id="cb110-17"><a href="#cb110-17"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred, <span class="at">group =</span> record_id, <span class="at">alpha =</span> .<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-83-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb111-2"><a href="#cb111-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb111-3"><a href="#cb111-3"></a>    <span class="fu">sample_n_of</span>(<span class="dv">50</span>,record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb111-4"><a href="#cb111-4"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb111-5"><a href="#cb111-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01)) <span class="sc">+</span></span>
<span id="cb111-6"><a href="#cb111-6"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred, <span class="at">group =</span> record_id, <span class="at">color =</span> record_id), <span class="at">.width =</span> <span class="dv">0</span>, <span class="at">show.legend =</span> F, <span class="at">alpha =</span> .<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-84-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a>melsm <span class="sc">%&gt;%</span> </span>
<span id="cb112-2"><a href="#cb112-2"></a>  <span class="fu">data_grid</span>(<span class="at">day01 =</span> <span class="fu">seq_range</span>(day01, <span class="at">n =</span> <span class="dv">20</span>), record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb112-3"><a href="#cb112-3"></a>    <span class="fu">sample_n_of</span>(<span class="dv">50</span>,record_id) <span class="sc">%&gt;%</span> </span>
<span id="cb112-4"><a href="#cb112-4"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>, <span class="at">re_formula =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb112-5"><a href="#cb112-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01)) <span class="sc">+</span></span>
<span id="cb112-6"><a href="#cb112-6"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred, <span class="at">group =</span> record_id, <span class="at">color =</span> record_id), <span class="at">.width =</span> <span class="dv">0</span>, <span class="at">show.legend =</span> F, <span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb112-7"><a href="#cb112-7"></a>  <span class="fu">stat_lineribbon</span>(<span class="at">data =</span> fixed.slope, <span class="fu">aes</span>(<span class="at">x =</span> day01, <span class="at">y =</span> .epred), <span class="at">show.legend =</span> F, <span class="at">alpha =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-85-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb113-2"><a href="#cb113-2"></a><span class="fu">predictions</span>(melsm<span class="fl">.1</span>, <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">record_id =</span> unique,<span class="at">day01 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb113-3"><a href="#cb113-3"></a>    <span class="fu">get_draws</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb113-4"><a href="#cb113-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01)) <span class="sc">+</span></span>
<span id="cb113-5"><a href="#cb113-5"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> draw, <span class="at">group =</span> record_id, <span class="at">color =</span> record_id), <span class="at">.width =</span> <span class="dv">0</span>, <span class="at">show.legend =</span> F, <span class="at">alpha =</span> .<span class="dv">4</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-86-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>fixed <span class="ot">&lt;-</span> <span class="fu">predictions</span>(melsm<span class="fl">.1</span>, <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">record_id =</span> <span class="cn">NA</span>, <span class="at">day01 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>), <span class="at">re.form =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span>  <span class="fu">get_draws</span>() </span>
<span id="cb114-2"><a href="#cb114-2"></a>  </span>
<span id="cb114-3"><a href="#cb114-3"></a></span>
<span id="cb114-4"><a href="#cb114-4"></a><span class="fu">predictions</span>(melsm<span class="fl">.1</span>, <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">record_id =</span> unique,<span class="at">day01 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb114-5"><a href="#cb114-5"></a>    <span class="fu">get_draws</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb114-6"><a href="#cb114-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day01)) <span class="sc">+</span></span>
<span id="cb114-7"><a href="#cb114-7"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> draw, <span class="at">group =</span> record_id, <span class="at">color =</span> record_id), <span class="at">.width =</span> <span class="dv">0</span>, <span class="at">show.legend =</span> F, <span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span> <span class="fu">stat_lineribbon</span>(<span class="at">data =</span> fixed, <span class="fu">aes</span>(<span class="at">y =</span> draw), <span class="at">.width =</span> <span class="dv">0</span>, <span class="at">show.legend =</span> F, <span class="at">color =</span> <span class="st">"Green"</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-87-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>What about interactions?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>melsm<span class="fl">.1</span>i <span class="ot">&lt;-</span></span>
<span id="cb115-2"><a href="#cb115-2"></a>  <span class="fu">brm</span>(<span class="at">family =</span> gaussian,</span>
<span id="cb115-3"><a href="#cb115-3"></a>      N_A.std <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> day01<span class="sc">+</span> P_A.std<span class="sc">*</span>steps.pm <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> day01 <span class="sc">|</span> record_id),</span>
<span id="cb115-4"><a href="#cb115-4"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb115-5"><a href="#cb115-5"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb115-6"><a href="#cb115-6"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb115-7"><a href="#cb115-7"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma),</span>
<span id="cb115-8"><a href="#cb115-8"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb115-9"><a href="#cb115-9"></a>      <span class="at">iter =</span> <span class="dv">3000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb115-10"><a href="#cb115-10"></a>      <span class="at">data =</span> melsm,</span>
<span id="cb115-11"><a href="#cb115-11"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb115-12"><a href="#cb115-12"></a>      <span class="at">file =</span> <span class="st">"melsm.1i"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="fu">summary</span>(melsm<span class="fl">.1</span>i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: N_A.std ~ 1 + day01 + P_A.std * steps.pm + (1 + day01 | record_id) 
   Data: melsm (Number of observations: 13033) 
  Draws: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
         total post-warmup draws = 8000

Multilevel Hyperparameters:
~record_id (Number of levels: 193) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.77      0.04     0.70     0.86 1.00     1391
sd(day01)                0.64      0.04     0.56     0.74 1.00     2542
cor(Intercept,day01)    -0.34      0.08    -0.48    -0.19 1.00     2545
                     Tail_ESS
sd(Intercept)            2398
sd(day01)                4247
cor(Intercept,day01)     4435

Regression Coefficients:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept            0.03      0.06    -0.08     0.14 1.01      627     1149
day01               -0.17      0.06    -0.28    -0.06 1.00     1983     3830
P_A.std             -0.05      0.01    -0.07    -0.03 1.00    13921     6668
steps.pm            -0.02      0.08    -0.18     0.14 1.00     1037     1850
P_A.std:steps.pm     0.02      0.02    -0.01     0.05 1.00    15598     6523

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.61      0.00     0.60     0.62 1.00    17245     5461

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb118-2"><a href="#cb118-2"></a><span class="fu">describe</span>(melsm<span class="sc">$</span>steps.pm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars     n mean   sd median trimmed  mad   min  max range skew kurtosis   se
X1    1 13033 0.05 0.63   0.05    0.04 0.54 -1.41 2.48   3.9 0.39     1.19 0.01</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb120-2"><a href="#cb120-2"></a>  <span class="fu">data_grid</span>(<span class="at">steps.pm =</span> <span class="fu">seq_range</span>(steps.pm, <span class="at">n =</span> <span class="dv">5</span>), <span class="at">P_A.std =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">day01 =</span> .<span class="dv">5</span>, <span class="at">.model =</span> melsm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 9
   steps.pm P_A.std day01   day P_A.lag N_A.lag steps.pmd record_id N_A.std
      &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1   -1.41       -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 2   -1.41        0   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 3   -1.41        1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 4   -0.441      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 5   -0.441       0   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 6   -0.441       1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 7    0.533      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 8    0.533       0   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 9    0.533       1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
10    1.51       -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
11    1.51        0   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
12    1.51        1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
13    2.48       -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
14    2.48        0   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
15    2.48        1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351</code></pre>
</div>
</div>
<p>5 * 3 = 15 rows</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb122-2"><a href="#cb122-2"></a>  <span class="fu">data_grid</span>(<span class="at">steps.pm =</span> <span class="fu">seq_range</span>(steps.pm, <span class="at">n =</span> <span class="dv">5</span>), <span class="at">P_A.std =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">day01 =</span> .<span class="dv">5</span>, <span class="at">.model =</span> melsm) <span class="sc">%&gt;%</span> </span>
<span id="cb122-3"><a href="#cb122-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>i, <span class="at">re_formula =</span> <span class="cn">NA</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120,000 × 14
# Groups:   steps.pm, P_A.std, day01, day, P_A.lag, N_A.lag, steps.pmd,
#   record_id, N_A.std, .row [15]
   steps.pm P_A.std day01   day P_A.lag N_A.lag steps.pmd record_id N_A.std
      &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 2    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 3    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 4    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 5    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 6    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 7    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 8    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
 9    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
10    -1.41      -1   0.5    41  0.0239  -0.418 -0.000672        96  -0.351
# ℹ 119,990 more rows
# ℹ 5 more variables: .row &lt;int&gt;, .chain &lt;int&gt;, .iteration &lt;int&gt;, .draw &lt;int&gt;,
#   .epred &lt;dbl&gt;</code></pre>
</div>
</div>
<p>12 * 8000 samples = 120,000 rows</p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a> melsm <span class="sc">%&gt;%</span> </span>
<span id="cb124-2"><a href="#cb124-2"></a>  <span class="fu">data_grid</span>(<span class="at">steps.pm =</span> <span class="fu">seq_range</span>(steps.pm, <span class="at">n =</span> <span class="dv">5</span>), <span class="at">P_A.std =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">day01 =</span> .<span class="dv">5</span>, <span class="at">.model =</span> melsm) <span class="sc">%&gt;%</span> </span>
<span id="cb124-3"><a href="#cb124-3"></a>  <span class="fu">add_epred_draws</span>(melsm<span class="fl">.1</span>i, <span class="at">re_formula =</span> <span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb124-4"><a href="#cb124-4"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x =</span> steps.pm, <span class="at">y =</span> N_A.std)) <span class="sc">+</span></span>
<span id="cb124-5"><a href="#cb124-5"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> .epred, <span class="at">group =</span> P_A.std, <span class="at">color =</span> <span class="fu">as.factor</span>(P_A.std)),  <span class="at">.width =</span> <span class="dv">0</span>, <span class="at">show.legend =</span> T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>

<img data-src="mlm-8_files/figure-revealjs/unnamed-chunk-93-1.png" width="960" class="r-stretch"><div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>